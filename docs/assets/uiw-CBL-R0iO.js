import{E as k,H as Oo,s as ln,a as _,I as Ro,g as Io,c as an,i as ut,T as Po,S as Ee,F as Te,f as ge,b as Be,N as qt,A as Ct,d as Pt,e as Ke,D as $o,h as O,C as Ei,j as Ti,m as xe,k as jt,l as No,P as cn,n as We,V as St,o as un,p as j,q as re,r as fn,t as D,u as Fe,R as Bi,v as P,w as Oi,x as Wo,y as Ri,z as Ii,B as ft,G as hn,M as Pi,J as $i,K as Ni,W as Wi,L as Fi,O as Ui,Q as Hi,U as Vi,X as zi,Y as qi,Z as ji,_ as Ki,$ as Gi,a0 as Ji,a1 as Qi,a2 as Yi,a3 as Zi,a4 as g,a5 as Xi}from"./codemirror-D0TfObNK.js";var Ge,y,Fo,de,Wn,Uo,Ho,Vo,dn,Kt,Gt,zo,Ue={},qo=[],es=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Je=Array.isArray;function Y(t,e){for(var n in e)t[n]=e[n];return t}function pn(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function ee(t,e,n){var o,r,i,s={};for(i in e)i=="key"?o=e[i]:i=="ref"?r=e[i]:s[i]=e[i];if(arguments.length>2&&(s.children=arguments.length>3?Ge.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(i in t.defaultProps)s[i]===void 0&&(s[i]=t.defaultProps[i]);return $e(t,s,o,r,null)}function $e(t,e,n,o,r){var i={type:t,props:e,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++Fo,__i:-1,__u:0};return r==null&&y.vnode!=null&&y.vnode(i),i}function jo(){return{current:null}}function te(t){return t.children}function J(t,e){this.props=t,this.context=e}function we(t,e){if(e==null)return t.__?we(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?we(t):null}function Ko(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Ko(t)}}function Jt(t){(!t.__d&&(t.__d=!0)&&de.push(t)&&!ht.__r++||Wn!==y.debounceRendering)&&((Wn=y.debounceRendering)||Uo)(ht)}function ht(){for(var t,e,n,o,r,i,s,l=1;de.length;)de.length>l&&de.sort(Ho),t=de.shift(),l=de.length,t.__d&&(n=void 0,r=(o=(e=t).__v).__e,i=[],s=[],e.__P&&((n=Y({},o)).__v=o.__v+1,y.vnode&&y.vnode(n),mn(e.__P,n,o,e.__n,e.__P.namespaceURI,32&o.__u?[r]:null,i,r??we(o),!!(32&o.__u),s),n.__v=o.__v,n.__.__k[n.__i]=n,Qo(i,n,s),n.__e!=r&&Ko(n)));ht.__r=0}function Go(t,e,n,o,r,i,s,l,a,c,f){var u,h,d,m,v,x,b=o&&o.__k||qo,p=e.length;for(a=ts(n,e,b,a,p),u=0;u<p;u++)(d=n.__k[u])!=null&&(h=d.__i===-1?Ue:b[d.__i]||Ue,d.__i=u,x=mn(t,d,h,r,i,s,l,a,c,f),m=d.__e,d.ref&&h.ref!=d.ref&&(h.ref&&gn(h.ref,null,d),f.push(d.ref,d.__c||m,d)),v==null&&m!=null&&(v=m),4&d.__u||h.__k===d.__k?a=Jo(d,a,t):typeof d.type=="function"&&x!==void 0?a=x:m&&(a=m.nextSibling),d.__u&=-7);return n.__e=v,a}function ts(t,e,n,o,r){var i,s,l,a,c,f=n.length,u=f,h=0;for(t.__k=new Array(r),i=0;i<r;i++)(s=e[i])!=null&&typeof s!="boolean"&&typeof s!="function"?(a=i+h,(s=t.__k[i]=typeof s=="string"||typeof s=="number"||typeof s=="bigint"||s.constructor==String?$e(null,s,null,null,null):Je(s)?$e(te,{children:s},null,null,null):s.constructor===void 0&&s.__b>0?$e(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s).__=t,s.__b=t.__b+1,l=null,(c=s.__i=ns(s,n,a,u))!==-1&&(u--,(l=n[c])&&(l.__u|=2)),l==null||l.__v===null?(c==-1&&(r>f?h--:r<f&&h++),typeof s.type!="function"&&(s.__u|=4)):c!=a&&(c==a-1?h--:c==a+1?h++:(c>a?h--:h++,s.__u|=4))):t.__k[i]=null;if(u)for(i=0;i<f;i++)(l=n[i])!=null&&(2&l.__u)==0&&(l.__e==o&&(o=we(l)),Zo(l,l));return o}function Jo(t,e,n){var o,r;if(typeof t.type=="function"){for(o=t.__k,r=0;o&&r<o.length;r++)o[r]&&(o[r].__=t,e=Jo(o[r],e,n));return e}t.__e!=e&&(e&&t.type&&!n.contains(e)&&(e=we(t)),n.insertBefore(t.__e,e||null),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function se(t,e){return e=e||[],t==null||typeof t=="boolean"||(Je(t)?t.some(function(n){se(n,e)}):e.push(t)),e}function ns(t,e,n,o){var r,i,s=t.key,l=t.type,a=e[n];if(a===null&&t.key==null||a&&s==a.key&&l===a.type&&(2&a.__u)==0)return n;if(o>(a!=null&&(2&a.__u)==0?1:0))for(r=n-1,i=n+1;r>=0||i<e.length;){if(r>=0){if((a=e[r])&&(2&a.__u)==0&&s==a.key&&l===a.type)return r;r--}if(i<e.length){if((a=e[i])&&(2&a.__u)==0&&s==a.key&&l===a.type)return i;i++}}return-1}function Fn(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||es.test(e)?n:n+"px"}function nt(t,e,n,o,r){var i;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof o=="string"&&(t.style.cssText=o=""),o)for(e in o)n&&e in n||Fn(t.style,e,"");if(n)for(e in n)o&&n[e]===o[e]||Fn(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")i=e!=(e=e.replace(Vo,"$1")),e=e.toLowerCase()in t||e=="onFocusOut"||e=="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+i]=n,n?o?n.t=o.t:(n.t=dn,t.addEventListener(e,i?Gt:Kt,i)):t.removeEventListener(e,i?Gt:Kt,i);else{if(r=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function Un(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.u==null)e.u=dn++;else if(e.u<n.t)return;return n(y.event?y.event(e):e)}}}function mn(t,e,n,o,r,i,s,l,a,c){var f,u,h,d,m,v,x,b,p,E,w,M,R,F,oe,A,z,T=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(a=!!(32&n.__u),i=[l=e.__e=n.__e]),(f=y.__b)&&f(e);e:if(typeof T=="function")try{if(b=e.props,p="prototype"in T&&T.prototype.render,E=(f=T.contextType)&&o[f.__c],w=f?E?E.props.value:f.__:o,n.__c?x=(u=e.__c=n.__c).__=u.__E:(p?e.__c=u=new T(b,w):(e.__c=u=new J(b,w),u.constructor=T,u.render=rs),E&&E.sub(u),u.props=b,u.state||(u.state={}),u.context=w,u.__n=o,h=u.__d=!0,u.__h=[],u._sb=[]),p&&u.__s==null&&(u.__s=u.state),p&&T.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=Y({},u.__s)),Y(u.__s,T.getDerivedStateFromProps(b,u.__s))),d=u.props,m=u.state,u.__v=e,h)p&&T.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),p&&u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(p&&T.getDerivedStateFromProps==null&&b!==d&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(b,w),!u.__e&&(u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(b,u.__s,w)===!1||e.__v==n.__v)){for(e.__v!=n.__v&&(u.props=b,u.state=u.__s,u.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(q){q&&(q.__=e)}),M=0;M<u._sb.length;M++)u.__h.push(u._sb[M]);u._sb=[],u.__h.length&&s.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(b,u.__s,w),p&&u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(d,m,v)})}if(u.context=w,u.props=b,u.__P=t,u.__e=!1,R=y.__r,F=0,p){for(u.state=u.__s,u.__d=!1,R&&R(e),f=u.render(u.props,u.state,u.context),oe=0;oe<u._sb.length;oe++)u.__h.push(u._sb[oe]);u._sb=[]}else do u.__d=!1,R&&R(e),f=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++F<25);u.state=u.__s,u.getChildContext!=null&&(o=Y(Y({},o),u.getChildContext())),p&&!h&&u.getSnapshotBeforeUpdate!=null&&(v=u.getSnapshotBeforeUpdate(d,m)),A=f,f!=null&&f.type===te&&f.key==null&&(A=Yo(f.props.children)),l=Go(t,Je(A)?A:[A],e,n,o,r,i,s,l,a,c),u.base=e.__e,e.__u&=-161,u.__h.length&&s.push(u),x&&(u.__E=u.__=null)}catch(q){if(e.__v=null,a||i!=null)if(q.then){for(e.__u|=a?160:128;l&&l.nodeType==8&&l.nextSibling;)l=l.nextSibling;i[i.indexOf(l)]=null,e.__e=l}else for(z=i.length;z--;)pn(i[z]);else e.__e=n.__e,e.__k=n.__k;y.__e(q,e,n)}else i==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):l=e.__e=os(n.__e,e,n,o,r,i,s,a,c);return(f=y.diffed)&&f(e),128&e.__u?void 0:l}function Qo(t,e,n){for(var o=0;o<n.length;o++)gn(n[o],n[++o],n[++o]);y.__c&&y.__c(e,t),t.some(function(r){try{t=r.__h,r.__h=[],t.some(function(i){i.call(r)})}catch(i){y.__e(i,r.__v)}})}function Yo(t){return typeof t!="object"||t==null?t:Je(t)?t.map(Yo):Y({},t)}function os(t,e,n,o,r,i,s,l,a){var c,f,u,h,d,m,v,x=n.props,b=e.props,p=e.type;if(p=="svg"?r="http://www.w3.org/2000/svg":p=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),i!=null){for(c=0;c<i.length;c++)if((d=i[c])&&"setAttribute"in d==!!p&&(p?d.localName==p:d.nodeType==3)){t=d,i[c]=null;break}}if(t==null){if(p==null)return document.createTextNode(b);t=document.createElementNS(r,p,b.is&&b),l&&(y.__m&&y.__m(e,i),l=!1),i=null}if(p===null)x===b||l&&t.data===b||(t.data=b);else{if(i=i&&Ge.call(t.childNodes),x=n.props||Ue,!l&&i!=null)for(x={},c=0;c<t.attributes.length;c++)x[(d=t.attributes[c]).name]=d.value;for(c in x)if(d=x[c],c!="children"){if(c=="dangerouslySetInnerHTML")u=d;else if(!(c in b)){if(c=="value"&&"defaultValue"in b||c=="checked"&&"defaultChecked"in b)continue;nt(t,c,null,d,r)}}for(c in b)d=b[c],c=="children"?h=d:c=="dangerouslySetInnerHTML"?f=d:c=="value"?m=d:c=="checked"?v=d:l&&typeof d!="function"||x[c]===d||nt(t,c,d,x[c],r);if(f)l||u&&(f.__html===u.__html||f.__html===t.innerHTML)||(t.innerHTML=f.__html),e.__k=[];else if(u&&(t.innerHTML=""),Go(e.type==="template"?t.content:t,Je(h)?h:[h],e,n,o,p=="foreignObject"?"http://www.w3.org/1999/xhtml":r,i,s,i?i[0]:n.__k&&we(n,0),l,a),i!=null)for(c=i.length;c--;)pn(i[c]);l||(c="value",p=="progress"&&m==null?t.removeAttribute("value"):m!==void 0&&(m!==t[c]||p=="progress"&&!m||p=="option"&&m!==x[c])&&nt(t,c,m,x[c],r),c="checked",v!==void 0&&v!==t[c]&&nt(t,c,v,x[c],r))}return t}function gn(t,e,n){try{if(typeof t=="function"){var o=typeof t.__u=="function";o&&t.__u(),o&&e==null||(t.__u=t(e))}else t.current=e}catch(r){y.__e(r,n)}}function Zo(t,e,n){var o,r;if(y.unmount&&y.unmount(t),(o=t.ref)&&(o.current&&o.current!==t.__e||gn(o,null,e)),(o=t.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(i){y.__e(i,e)}o.base=o.__P=null}if(o=t.__k)for(r=0;r<o.length;r++)o[r]&&Zo(o[r],e,n||typeof t.type!="function");n||pn(t.__e),t.__c=t.__=t.__e=void 0}function rs(t,e,n){return this.constructor(t,n)}function He(t,e,n){var o,r,i,s;e==document&&(e=document.documentElement),y.__&&y.__(t,e),r=(o=typeof n=="function")?null:n&&n.__k||e.__k,i=[],s=[],mn(e,t=(!o&&n||e).__k=ee(te,null,[t]),r||Ue,Ue,e.namespaceURI,!o&&n?[n]:r?null:e.firstChild?Ge.call(e.childNodes):null,i,!o&&n?n:r?r.__e:e.firstChild,o,s),Qo(i,t,s)}function Xo(t,e){He(t,e,Xo)}function is(t,e,n){var o,r,i,s,l=Y({},t.props);for(i in t.type&&t.type.defaultProps&&(s=t.type.defaultProps),e)i=="key"?o=e[i]:i=="ref"?r=e[i]:l[i]=e[i]===void 0&&s!==void 0?s[i]:e[i];return arguments.length>2&&(l.children=arguments.length>3?Ge.call(arguments,2):n),$e(t.type,l,o||t.key,r||t.ref,null)}function er(t){function e(n){var o,r;return this.getChildContext||(o=new Set,(r={})[e.__c]=this,this.getChildContext=function(){return r},this.componentWillUnmount=function(){o=null},this.shouldComponentUpdate=function(i){this.props.value!==i.value&&o.forEach(function(s){s.__e=!0,Jt(s)})},this.sub=function(i){o.add(i);var s=i.componentWillUnmount;i.componentWillUnmount=function(){o&&o.delete(i),s&&s.call(i)}}),n.children}return e.__c="__cC"+zo++,e.__=t,e.Provider=e.__l=(e.Consumer=function(n,o){return n.children(o)}).contextType=e,e}Ge=qo.slice,y={__e:function(t,e,n,o){for(var r,i,s;e=e.__;)if((r=e.__c)&&!r.__)try{if((i=r.constructor)&&i.getDerivedStateFromError!=null&&(r.setState(i.getDerivedStateFromError(t)),s=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(t,o||{}),s=r.__d),s)return r.__E=r}catch(l){t=l}throw t}},Fo=0,J.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Y({},this.state),typeof t=="function"&&(t=t(Y({},n),this.props)),t&&Y(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),Jt(this))},J.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Jt(this))},J.prototype.render=te,de=[],Uo=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ho=function(t,e){return t.__v.__b-e.__v.__b},ht.__r=0,Vo=/(PointerCapture)$|Capture$/i,dn=0,Kt=Un(!1),Gt=Un(!0),zo=0;var ss=0;function ls(t,e,n,o,r,i){e||(e={});var s,l,a=e;if("ref"in a)for(l in a={},e)l=="ref"?s=e[l]:a[l]=e[l];var c={type:t,props:a,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--ss,__i:-1,__u:0,__source:r,__self:i};if(typeof t=="function"&&(s=t.defaultProps))for(l in s)a[l]===void 0&&(a[l]=s[l]);return y.vnode&&y.vnode(c),c}var le,C,$t,Hn,Me=0,tr=[],L=y,Vn=L.__b,zn=L.__r,qn=L.diffed,jn=L.__c,Kn=L.unmount,Gn=L.__;function _e(t,e){L.__h&&L.__h(C,t,Me||e),Me=0;var n=C.__H||(C.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function ae(t){return Me=1,At(nr,t)}function At(t,e,n){var o=_e(le++,2);if(o.t=t,!o.__c&&(o.__=[n?n(e):nr(void 0,e),function(l){var a=o.__N?o.__N[0]:o.__[0],c=o.t(a,l);a!==c&&(o.__N=[c,o.__[1]],o.__c.setState({}))}],o.__c=C,!C.__f)){var r=function(l,a,c){if(!o.__c.__H)return!0;var f=o.__c.__H.__.filter(function(h){return!!h.__c});if(f.every(function(h){return!h.__N}))return!i||i.call(this,l,a,c);var u=o.__c.props!==l;return f.forEach(function(h){if(h.__N){var d=h.__[0];h.__=h.__N,h.__N=void 0,d!==h.__[0]&&(u=!0)}}),i&&i.call(this,l,a,c)||u};C.__f=!0;var i=C.shouldComponentUpdate,s=C.componentWillUpdate;C.componentWillUpdate=function(l,a,c){if(this.__e){var f=i;i=void 0,r(l,a,c),i=f}s&&s.call(this,l,a,c)},C.shouldComponentUpdate=r}return o.__N||o.__}function ie(t,e){var n=_e(le++,3);!L.__s&&vn(n.__H,e)&&(n.__=t,n.u=e,C.__H.__h.push(n))}function ye(t,e){var n=_e(le++,4);!L.__s&&vn(n.__H,e)&&(n.__=t,n.u=e,C.__h.push(n))}function wt(t){return Me=5,Qe(function(){return{current:t}},[])}function Mt(t,e,n){Me=6,ye(function(){if(typeof t=="function"){var o=t(e());return function(){t(null),o&&typeof o=="function"&&o()}}if(t)return t.current=e(),function(){return t.current=null}},n==null?n:n.concat(t))}function Qe(t,e){var n=_e(le++,7);return vn(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function Lt(t,e){return Me=8,Qe(function(){return t},e)}function _n(t){var e=C.context[t.__c],n=_e(le++,9);return n.c=t,e?(n.__==null&&(n.__=!0,e.sub(C)),e.props.value):t.__}function yn(t,e){L.useDebugValue&&L.useDebugValue(e?e(t):t)}function as(t){var e=_e(le++,10),n=ae();return e.__=t,C.componentDidCatch||(C.componentDidCatch=function(o,r){e.__&&e.__(o,r),n[1](o)}),[n[0],function(){n[1](void 0)}]}function bn(){var t=_e(le++,11);if(!t.__){for(var e=C.__v;e!==null&&!e.__m&&e.__!==null;)e=e.__;var n=e.__m||(e.__m=[0,0]);t.__="P"+n[0]+"-"+n[1]++}return t.__}function cs(){for(var t;t=tr.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(at),t.__H.__h.forEach(Qt),t.__H.__h=[]}catch(e){t.__H.__h=[],L.__e(e,t.__v)}}L.__b=function(t){C=null,Vn&&Vn(t)},L.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),Gn&&Gn(t,e)},L.__r=function(t){zn&&zn(t),le=0;var e=(C=t.__c).__H;e&&($t===C?(e.__h=[],C.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.forEach(at),e.__h.forEach(Qt),e.__h=[],le=0)),$t=C},L.diffed=function(t){qn&&qn(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(tr.push(e)!==1&&Hn===L.requestAnimationFrame||((Hn=L.requestAnimationFrame)||us)(cs)),e.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),$t=C=null},L.__c=function(t,e){e.some(function(n){try{n.__h.forEach(at),n.__h=n.__h.filter(function(o){return!o.__||Qt(o)})}catch(o){e.some(function(r){r.__h&&(r.__h=[])}),e=[],L.__e(o,n.__v)}}),jn&&jn(t,e)},L.unmount=function(t){Kn&&Kn(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{at(o)}catch(r){e=r}}),n.__H=void 0,e&&L.__e(e,n.__v))};var Jn=typeof requestAnimationFrame=="function";function us(t){var e,n=function(){clearTimeout(o),Jn&&cancelAnimationFrame(e),setTimeout(t)},o=setTimeout(n,100);Jn&&(e=requestAnimationFrame(n))}function at(t){var e=C,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),C=e}function Qt(t){var e=C;t.__c=t.__(),C=e}function vn(t,e){return!t||t.length!==e.length||e.some(function(n,o){return n!==t[o]})}function nr(t,e){return typeof e=="function"?e(t):e}function or(t,e){for(var n in e)t[n]=e[n];return t}function Yt(t,e){for(var n in t)if(n!=="__source"&&!(n in e))return!0;for(var o in e)if(o!=="__source"&&t[o]!==e[o])return!0;return!1}function xn(t,e){var n=e(),o=ae({t:{__:n,u:e}}),r=o[0].t,i=o[1];return ye(function(){r.__=n,r.u=e,Nt(r)&&i({t:r})},[t,n,e]),ie(function(){return Nt(r)&&i({t:r}),t(function(){Nt(r)&&i({t:r})})},[t]),n}function Nt(t){var e,n,o=t.u,r=t.__;try{var i=o();return!((e=r)===(n=i)&&(e!==0||1/e==1/n)||e!=e&&n!=n)}catch{return!0}}function kn(t){t()}function Cn(t){return t}function Sn(){return[!1,kn]}var An=ye;function dt(t,e){this.props=t,this.context=e}function rr(t,e){function n(r){var i=this.props.ref,s=i==r.ref;return!s&&i&&(i.call?i(null):i.current=null),e?!e(this.props,r)||!s:Yt(this.props,r)}function o(r){return this.shouldComponentUpdate=n,ee(t,r)}return o.displayName="Memo("+(t.displayName||t.name)+")",o.prototype.isReactComponent=!0,o.__f=!0,o}(dt.prototype=new J).isPureReactComponent=!0,dt.prototype.shouldComponentUpdate=function(t,e){return Yt(this.props,t)||Yt(this.state,e)};var Qn=y.__b;y.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),Qn&&Qn(t)};var fs=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function wn(t){function e(n){var o=or({},n);return delete o.ref,t(o,n.ref||null)}return e.$$typeof=fs,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(t.displayName||t.name)+")",e}var Yn=function(t,e){return t==null?null:se(se(t).map(e))},ir={map:Yn,forEach:Yn,count:function(t){return t?se(t).length:0},only:function(t){var e=se(t);if(e.length!==1)throw"Children.only";return e[0]},toArray:se},hs=y.__e;y.__e=function(t,e,n,o){if(t.then){for(var r,i=e;i=i.__;)if((r=i.__c)&&r.__c)return e.__e==null&&(e.__e=n.__e,e.__k=n.__k),r.__c(t,e)}hs(t,e,n,o)};var Zn=y.unmount;function sr(t,e,n){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach(function(o){typeof o.__c=="function"&&o.__c()}),t.__c.__H=null),(t=or({},t)).__c!=null&&(t.__c.__P===n&&(t.__c.__P=e),t.__c=null),t.__k=t.__k&&t.__k.map(function(o){return sr(o,e,n)})),t}function lr(t,e,n){return t&&n&&(t.__v=null,t.__k=t.__k&&t.__k.map(function(o){return lr(o,e,n)}),t.__c&&t.__c.__P===e&&(t.__e&&n.appendChild(t.__e),t.__c.__e=!0,t.__c.__P=n)),t}function Ne(){this.__u=0,this.o=null,this.__b=null}function ar(t){var e=t.__.__c;return e&&e.__a&&e.__a(t)}function cr(t){var e,n,o;function r(i){if(e||(e=t()).then(function(s){n=s.default||s},function(s){o=s}),o)throw o;if(!n)throw e;return ee(n,i)}return r.displayName="Lazy",r.__f=!0,r}function ke(){this.i=null,this.l=null}y.unmount=function(t){var e=t.__c;e&&e.__R&&e.__R(),e&&32&t.__u&&(t.type=null),Zn&&Zn(t)},(Ne.prototype=new J).__c=function(t,e){var n=e.__c,o=this;o.o==null&&(o.o=[]),o.o.push(n);var r=ar(o.__v),i=!1,s=function(){i||(i=!0,n.__R=null,r?r(l):l())};n.__R=s;var l=function(){if(!--o.__u){if(o.state.__a){var a=o.state.__a;o.__v.__k[0]=lr(a,a.__c.__P,a.__c.__O)}var c;for(o.setState({__a:o.__b=null});c=o.o.pop();)c.forceUpdate()}};o.__u++||32&e.__u||o.setState({__a:o.__b=o.__v.__k[0]}),t.then(s,s)},Ne.prototype.componentWillUnmount=function(){this.o=[]},Ne.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),o=this.__v.__k[0].__c;this.__v.__k[0]=sr(this.__b,n,o.__O=o.__P)}this.__b=null}var r=e.__a&&ee(te,null,t.fallback);return r&&(r.__u&=-33),[ee(te,null,e.__a?null:t.children),r]};var Xn=function(t,e,n){if(++n[1]===n[0]&&t.l.delete(e),t.props.revealOrder&&(t.props.revealOrder[0]!=="t"||!t.l.size))for(n=t.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;t.i=n=n[2]}};function ds(t){return this.getChildContext=function(){return t.context},t.children}function ps(t){var e=this,n=t.h;e.componentWillUnmount=function(){He(null,e.v),e.v=null,e.h=null},e.h&&e.h!==n&&e.componentWillUnmount(),e.v||(e.h=n,e.v={nodeType:1,parentNode:n,childNodes:[],contains:function(){return!0},appendChild:function(o){this.childNodes.push(o),e.h.appendChild(o)},insertBefore:function(o,r){this.childNodes.push(o),e.h.insertBefore(o,r)},removeChild:function(o){this.childNodes.splice(this.childNodes.indexOf(o)>>>1,1),e.h.removeChild(o)}}),He(ee(ds,{context:e.context},t.__v),e.v)}function ur(t,e){var n=ee(ps,{__v:t,h:e});return n.containerInfo=e,n}(ke.prototype=new J).__a=function(t){var e=this,n=ar(e.__v),o=e.l.get(t);return o[0]++,function(r){var i=function(){e.props.revealOrder?(o.push(r),Xn(e,t,o)):r()};n?n(i):i()}},ke.prototype.render=function(t){this.i=null,this.l=new Map;var e=se(t.children);t.revealOrder&&t.revealOrder[0]==="b"&&e.reverse();for(var n=e.length;n--;)this.l.set(e[n],this.i=[1,0,this.i]);return t.children},ke.prototype.componentDidUpdate=ke.prototype.componentDidMount=function(){var t=this;this.l.forEach(function(e,n){Xn(t,n,e)})};var fr=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,ms=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,gs=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,_s=/[A-Z0-9]/g,ys=typeof document<"u",bs=function(t){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(t)};function hr(t,e,n){return e.__k==null&&(e.textContent=""),He(t,e),typeof n=="function"&&n(),t?t.__c:null}function dr(t,e,n){return Xo(t,e),typeof n=="function"&&n(),t?t.__c:null}J.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(t){Object.defineProperty(J.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})});var eo=y.event;function vs(){}function xs(){return this.cancelBubble}function ks(){return this.defaultPrevented}y.event=function(t){return eo&&(t=eo(t)),t.persist=vs,t.isPropagationStopped=xs,t.isDefaultPrevented=ks,t.nativeEvent=t};var Mn,Cs={enumerable:!1,configurable:!0,get:function(){return this.class}},to=y.vnode;y.vnode=function(t){typeof t.type=="string"&&function(e){var n=e.props,o=e.type,r={},i=o.indexOf("-")===-1;for(var s in n){var l=n[s];if(!(s==="value"&&"defaultValue"in n&&l==null||ys&&s==="children"&&o==="noscript"||s==="class"||s==="className")){var a=s.toLowerCase();s==="defaultValue"&&"value"in n&&n.value==null?s="value":s==="download"&&l===!0?l="":a==="translate"&&l==="no"?l=!1:a[0]==="o"&&a[1]==="n"?a==="ondoubleclick"?s="ondblclick":a!=="onchange"||o!=="input"&&o!=="textarea"||bs(n.type)?a==="onfocus"?s="onfocusin":a==="onblur"?s="onfocusout":gs.test(s)&&(s=a):a=s="oninput":i&&ms.test(s)?s=s.replace(_s,"-$&").toLowerCase():l===null&&(l=void 0),a==="oninput"&&r[s=a]&&(s="oninputCapture"),r[s]=l}}o=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=se(n.children).forEach(function(c){c.props.selected=r.value.indexOf(c.props.value)!=-1})),o=="select"&&r.defaultValue!=null&&(r.value=se(n.children).forEach(function(c){c.props.selected=r.multiple?r.defaultValue.indexOf(c.props.value)!=-1:r.defaultValue==c.props.value})),n.class&&!n.className?(r.class=n.class,Object.defineProperty(r,"className",Cs)):(n.className&&!n.class||n.class&&n.className)&&(r.class=r.className=n.className),e.props=r}(t),t.$$typeof=fr,to&&to(t)};var no=y.__r;y.__r=function(t){no&&no(t),Mn=t.__c};var oo=y.diffed;y.diffed=function(t){oo&&oo(t);var e=t.props,n=t.__e;n!=null&&t.type==="textarea"&&"value"in e&&e.value!==n.value&&(n.value=e.value==null?"":e.value),Mn=null};var pr={ReactCurrentDispatcher:{current:{readContext:function(t){return Mn.__n[t.__c].props.value},useCallback:Lt,useContext:_n,useDebugValue:yn,useDeferredValue:Cn,useEffect:ie,useId:bn,useImperativeHandle:Mt,useInsertionEffect:An,useLayoutEffect:ye,useMemo:Qe,useReducer:At,useRef:wt,useState:ae,useSyncExternalStore:xn,useTransition:Sn}}},Ss="18.3.1";function mr(t){return ee.bind(null,t)}function Ye(t){return!!t&&t.$$typeof===fr}function gr(t){return Ye(t)&&t.type===te}function _r(t){return!!t&&!!t.displayName&&(typeof t.displayName=="string"||t.displayName instanceof String)&&t.displayName.startsWith("Memo(")}function yr(t){return Ye(t)?is.apply(null,arguments):t}function br(t){return!!t.__k&&(He(null,t),!0)}function vr(t){return t&&(t.base||t.nodeType===1&&t)||null}var xr=function(t,e){return t(e)},kr=function(t,e){return t(e)},Cr=te,Sr=Ye,As={useState:ae,useId:bn,useReducer:At,useEffect:ie,useLayoutEffect:ye,useInsertionEffect:An,useTransition:Sn,useDeferredValue:Cn,useSyncExternalStore:xn,startTransition:kn,useRef:wt,useImperativeHandle:Mt,useMemo:Qe,useCallback:Lt,useContext:_n,useDebugValue:yn,version:"18.3.1",Children:ir,render:hr,hydrate:dr,unmountComponentAtNode:br,createPortal:ur,createElement:ee,createContext:er,createFactory:mr,cloneElement:yr,createRef:jo,Fragment:te,isValidElement:Ye,isElement:Sr,isFragment:gr,isMemo:_r,findDOMNode:vr,Component:J,PureComponent:dt,memo:rr,forwardRef:wn,flushSync:kr,unstable_batchedUpdates:xr,StrictMode:Cr,Suspense:Ne,SuspenseList:ke,lazy:cr,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:pr};const Bc=Object.freeze(Object.defineProperty({__proto__:null,Children:ir,Component:J,Fragment:te,PureComponent:dt,StrictMode:Cr,Suspense:Ne,SuspenseList:ke,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:pr,cloneElement:yr,createContext:er,createElement:ee,createFactory:mr,createPortal:ur,createRef:jo,default:As,findDOMNode:vr,flushSync:kr,forwardRef:wn,hydrate:dr,isElement:Sr,isFragment:gr,isMemo:_r,isValidElement:Ye,lazy:cr,memo:rr,render:hr,startTransition:kn,unmountComponentAtNode:br,unstable_batchedUpdates:xr,useCallback:Lt,useContext:_n,useDebugValue:yn,useDeferredValue:Cn,useEffect:ie,useErrorBoundary:as,useId:bn,useImperativeHandle:Mt,useInsertionEffect:An,useLayoutEffect:ye,useMemo:Qe,useReducer:At,useRef:wt,useState:ae,useSyncExternalStore:xn,useTransition:Sn,version:Ss},Symbol.toStringTag,{value:"Module"}));var Oc=t=>{var{theme:e,settings:n={},styles:o=[]}=t,r={".cm-gutters":{}},i={};n.background&&(i.backgroundColor=n.background),n.backgroundImage&&(i.backgroundImage=n.backgroundImage),n.foreground&&(i.color=n.foreground),n.fontSize&&(i.fontSize=n.fontSize),(n.background||n.foreground)&&(r["&"]=i),n.fontFamily&&(r["&.cm-editor .cm-scroller"]={fontFamily:n.fontFamily}),n.gutterBackground&&(r[".cm-gutters"].backgroundColor=n.gutterBackground),n.gutterForeground&&(r[".cm-gutters"].color=n.gutterForeground),n.gutterBorder&&(r[".cm-gutters"].borderRightColor=n.gutterBorder),n.caret&&(r[".cm-content"]={caretColor:n.caret},r[".cm-cursor, .cm-dropCursor"]={borderLeftColor:n.caret});var s={};n.gutterActiveForeground&&(s.color=n.gutterActiveForeground),n.lineHighlight&&(r[".cm-activeLine"]={backgroundColor:n.lineHighlight},s.backgroundColor=n.lineHighlight),r[".cm-activeLineGutter"]=s,n.selection&&(r["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:n.selection+" !important"}),n.selectionMatch&&(r["& .cm-selectionMatch"]={backgroundColor:n.selectionMatch});var l=k.theme(r,{dark:e==="dark"}),a=Oo.define(o),c=[l,ln(a)];return c};function Zt(){return Zt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)({}).hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Zt.apply(null,arguments)}function ws(t,e){if(t==null)return{};var n={};for(var o in t)if({}.hasOwnProperty.call(t,o)){if(e.includes(o))continue;n[o]=t[o]}return n}const Ms=t=>{let{state:e}=t,n=e.doc.lineAt(e.selection.main.from),o=Dn(t.state,n.from);return o.line?Ls(t):o.block?Es(t):!1};function Ln(t,e){return({state:n,dispatch:o})=>{if(n.readOnly)return!1;let r=t(e,n);return r?(o(n.update(r)),!0):!1}}const Ls=Ln(Os,0),Ds=Ln(Ar,0),Es=Ln((t,e)=>Ar(t,e,Bs(e)),0);function Dn(t,e){let n=t.languageDataAt("commentTokens",e);return n.length?n[0]:{}}const Pe=50;function Ts(t,{open:e,close:n},o,r){let i=t.sliceDoc(o-Pe,o),s=t.sliceDoc(r,r+Pe),l=/\s*$/.exec(i)[0].length,a=/^\s*/.exec(s)[0].length,c=i.length-l;if(i.slice(c-e.length,c)==e&&s.slice(a,a+n.length)==n)return{open:{pos:o-l,margin:l&&1},close:{pos:r+a,margin:a&&1}};let f,u;r-o<=2*Pe?f=u=t.sliceDoc(o,r):(f=t.sliceDoc(o,o+Pe),u=t.sliceDoc(r-Pe,r));let h=/^\s*/.exec(f)[0].length,d=/\s*$/.exec(u)[0].length,m=u.length-d-n.length;return f.slice(h,h+e.length)==e&&u.slice(m,m+n.length)==n?{open:{pos:o+h+e.length,margin:/\s/.test(f.charAt(h+e.length))?1:0},close:{pos:r-d-n.length,margin:/\s/.test(u.charAt(m-1))?1:0}}:null}function Bs(t){let e=[];for(let n of t.selection.ranges){let o=t.doc.lineAt(n.from),r=n.to<=o.to?o:t.doc.lineAt(n.to),i=e.length-1;i>=0&&e[i].to>o.from?e[i].to=r.to:e.push({from:o.from+/^\s*/.exec(o.text)[0].length,to:r.to})}return e}function Ar(t,e,n=e.selection.ranges){let o=n.map(i=>Dn(e,i.from).block);if(!o.every(i=>i))return null;let r=n.map((i,s)=>Ts(e,o[s],i.from,i.to));if(t!=2&&!r.every(i=>i))return{changes:e.changes(n.map((i,s)=>r[s]?[]:[{from:i.from,insert:o[s].open+" "},{from:i.to,insert:" "+o[s].close}]))};if(t!=1&&r.some(i=>i)){let i=[];for(let s=0,l;s<r.length;s++)if(l=r[s]){let a=o[s],{open:c,close:f}=l;i.push({from:c.pos-a.open.length,to:c.pos+c.margin},{from:f.pos-f.margin,to:f.pos+a.close.length})}return{changes:i}}return null}function Os(t,e,n=e.selection.ranges){let o=[],r=-1;for(let{from:i,to:s}of n){let l=o.length,a=1e9,c=Dn(e,i).line;if(c){for(let f=i;f<=s;){let u=e.doc.lineAt(f);if(u.from>r&&(i==s||s>u.from)){r=u.from;let h=/^\s*/.exec(u.text)[0].length,d=h==u.length,m=u.text.slice(h,h+c.length)==c?h:-1;h<u.text.length&&h<a&&(a=h),o.push({line:u,comment:m,token:c,indent:h,empty:d,single:!1})}f=u.to+1}if(a<1e9)for(let f=l;f<o.length;f++)o[f].indent<o[f].line.text.length&&(o[f].indent=a);o.length==l+1&&(o[l].single=!0)}}if(t!=2&&o.some(i=>i.comment<0&&(!i.empty||i.single))){let i=[];for(let{line:l,token:a,indent:c,empty:f,single:u}of o)(u||!f)&&i.push({from:l.from+c,insert:a+" "});let s=e.changes(i);return{changes:s,selection:e.selection.map(s,1)}}else if(t!=1&&o.some(i=>i.comment>=0)){let i=[];for(let{line:s,comment:l,token:a}of o)if(l>=0){let c=s.from+l,f=c+a.length;s.text[f-s.from]==" "&&f++,i.push({from:c,to:f})}return{changes:i}}return null}const Xt=Ct.define(),Rs=Ct.define(),Is=Te.define(),wr=Te.define({combine(t){return Ke(t,{minDepth:100,newGroupDelay:500,joinToEvent:(e,n)=>n},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,n)=>(o,r)=>e(o,r)||n(o,r)})}}),Mr=Ee.define({create(){return Z.empty},update(t,e){let n=e.state.facet(wr),o=e.annotation(Xt);if(o){let a=W.fromTransaction(e,o.selection),c=o.side,f=c==0?t.undone:t.done;return a?f=pt(f,f.length,n.minDepth,a):f=Er(f,e.startState.selection),new Z(c==0?o.rest:f,c==0?f:o.rest)}let r=e.annotation(Rs);if((r=="full"||r=="before")&&(t=t.isolate()),e.annotation(Pt.addToHistory)===!1)return e.changes.empty?t:t.addMapping(e.changes.desc);let i=W.fromTransaction(e),s=e.annotation(Pt.time),l=e.annotation(Pt.userEvent);return i?t=t.addChanges(i,s,l,n,e):e.selection&&(t=t.addSelection(e.startState.selection,s,l,n.newGroupDelay)),(r=="full"||r=="after")&&(t=t.isolate()),t},toJSON(t){return{done:t.done.map(e=>e.toJSON()),undone:t.undone.map(e=>e.toJSON())}},fromJSON(t){return new Z(t.done.map(W.fromJSON),t.undone.map(W.fromJSON))}});function Ps(t={}){return[Mr,wr.of(t),k.domEventHandlers({beforeinput(e,n){let o=e.inputType=="historyUndo"?Lr:e.inputType=="historyRedo"?en:null;return o?(e.preventDefault(),o(n)):!1}})]}function Dt(t,e){return function({state:n,dispatch:o}){if(!e&&n.readOnly)return!1;let r=n.field(Mr,!1);if(!r)return!1;let i=r.pop(t,n,e);return i?(o(i),!0):!1}}const Lr=Dt(0,!1),en=Dt(1,!1),$s=Dt(0,!0),Ns=Dt(1,!0);class W{constructor(e,n,o,r,i){this.changes=e,this.effects=n,this.mapped=o,this.startSelection=r,this.selectionsAfter=i}setSelAfter(e){return new W(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,n,o;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(n=this.mapped)===null||n===void 0?void 0:n.toJSON(),startSelection:(o=this.startSelection)===null||o===void 0?void 0:o.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new W(e.changes&&Ei.fromJSON(e.changes),[],e.mapped&&Ti.fromJSON(e.mapped),e.startSelection&&_.fromJSON(e.startSelection),e.selectionsAfter.map(_.fromJSON))}static fromTransaction(e,n){let o=K;for(let r of e.startState.facet(Is)){let i=r(e);i.length&&(o=o.concat(i))}return!o.length&&e.changes.empty?null:new W(e.changes.invert(e.startState.doc),o,void 0,n||e.startState.selection,K)}static selection(e){return new W(void 0,K,void 0,void 0,e)}}function pt(t,e,n,o){let r=e+1>n+20?e-n-1:0,i=t.slice(r,e);return i.push(o),i}function Ws(t,e){let n=[],o=!1;return t.iterChangedRanges((r,i)=>n.push(r,i)),e.iterChangedRanges((r,i,s,l)=>{for(let a=0;a<n.length;){let c=n[a++],f=n[a++];l>=c&&s<=f&&(o=!0)}}),o}function Fs(t,e){return t.ranges.length==e.ranges.length&&t.ranges.filter((n,o)=>n.empty!=e.ranges[o].empty).length===0}function Dr(t,e){return t.length?e.length?t.concat(e):t:e}const K=[],Us=200;function Er(t,e){if(t.length){let n=t[t.length-1],o=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-Us));return o.length&&o[o.length-1].eq(e)?t:(o.push(e),pt(t,t.length-1,1e9,n.setSelAfter(o)))}else return[W.selection([e])]}function Hs(t){let e=t[t.length-1],n=t.slice();return n[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),n}function Wt(t,e){if(!t.length)return t;let n=t.length,o=K;for(;n;){let r=Vs(t[n-1],e,o);if(r.changes&&!r.changes.empty||r.effects.length){let i=t.slice(0,n);return i[n-1]=r,i}else e=r.mapped,n--,o=r.selectionsAfter}return o.length?[W.selection(o)]:K}function Vs(t,e,n){let o=Dr(t.selectionsAfter.length?t.selectionsAfter.map(l=>l.map(e)):K,n);if(!t.changes)return W.selection(o);let r=t.changes.map(e),i=e.mapDesc(t.changes,!0),s=t.mapped?t.mapped.composeDesc(i):i;return new W(r,O.mapEffects(t.effects,e),s,t.startSelection.map(i),o)}const zs=/^(input\.type|delete)($|\.)/;class Z{constructor(e,n,o=0,r=void 0){this.done=e,this.undone=n,this.prevTime=o,this.prevUserEvent=r}isolate(){return this.prevTime?new Z(this.done,this.undone):this}addChanges(e,n,o,r,i){let s=this.done,l=s[s.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!o||zs.test(o))&&(!l.selectionsAfter.length&&n-this.prevTime<r.newGroupDelay&&r.joinToEvent(i,Ws(l.changes,e.changes))||o=="input.type.compose")?s=pt(s,s.length-1,r.minDepth,new W(e.changes.compose(l.changes),Dr(O.mapEffects(e.effects,l.changes),l.effects),l.mapped,l.startSelection,K)):s=pt(s,s.length,r.minDepth,e),new Z(s,K,n,o)}addSelection(e,n,o,r){let i=this.done.length?this.done[this.done.length-1].selectionsAfter:K;return i.length>0&&n-this.prevTime<r&&o==this.prevUserEvent&&o&&/^select($|\.)/.test(o)&&Fs(i[i.length-1],e)?this:new Z(Er(this.done,e),this.undone,n,o)}addMapping(e){return new Z(Wt(this.done,e),Wt(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,n,o){let r=e==0?this.done:this.undone;if(r.length==0)return null;let i=r[r.length-1],s=i.selectionsAfter[0]||n.selection;if(o&&i.selectionsAfter.length)return n.update({selection:i.selectionsAfter[i.selectionsAfter.length-1],annotations:Xt.of({side:e,rest:Hs(r),selection:s}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(i.changes){let l=r.length==1?K:r.slice(0,r.length-1);return i.mapped&&(l=Wt(l,i.mapped)),n.update({changes:i.changes,selection:i.startSelection,effects:i.effects,annotations:Xt.of({side:e,rest:l,selection:s}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Z.empty=new Z(K,K);const qs=[{key:"Mod-z",run:Lr,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:en,preventDefault:!0},{linux:"Ctrl-Shift-z",run:en,preventDefault:!0},{key:"Mod-u",run:$s,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Ns,preventDefault:!0}];function Oe(t,e){return _.create(t.ranges.map(e),t.mainIndex)}function ne(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Q({state:t,dispatch:e},n){let o=Oe(t.selection,n);return o.eq(t.selection,!0)?!1:(e(ne(t,o)),!0)}function Et(t,e){return _.cursor(e?t.to:t.from)}function Tr(t,e){return Q(t,n=>n.empty?t.moveByChar(n,e):Et(n,e))}function I(t){return t.textDirectionAt(t.state.selection.main.head)==$o.LTR}const Br=t=>Tr(t,!I(t)),Or=t=>Tr(t,I(t));function Rr(t,e){return Q(t,n=>n.empty?t.moveByGroup(n,e):Et(n,e))}const js=t=>Rr(t,!I(t)),Ks=t=>Rr(t,I(t));function Gs(t,e,n){if(e.type.prop(n))return!0;let o=e.to-e.from;return o&&(o>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function Tt(t,e,n){let o=Be(t).resolveInner(e.head),r=n?qt.closedBy:qt.openedBy;for(let a=e.head;;){let c=n?o.childAfter(a):o.childBefore(a);if(!c)break;Gs(t,c,r)?o=c:a=n?c.to:c.from}let i=o.type.prop(r),s,l;return i&&(s=n?xe(t,o.from,1):xe(t,o.to,-1))&&s.matched?l=n?s.end.to:s.end.from:l=n?o.to:o.from,_.cursor(l,n?-1:1)}const Js=t=>Q(t,e=>Tt(t.state,e,!I(t))),Qs=t=>Q(t,e=>Tt(t.state,e,I(t)));function Ir(t,e){return Q(t,n=>{if(!n.empty)return Et(n,e);let o=t.moveVertically(n,e);return o.head!=n.head?o:t.moveToLineBoundary(n,e)})}const Pr=t=>Ir(t,!1),$r=t=>Ir(t,!0);function Nr(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,n=0,o=0,r;if(e){for(let i of t.state.facet(k.scrollMargins)){let s=i(t);s!=null&&s.top&&(n=Math.max(s==null?void 0:s.top,n)),s!=null&&s.bottom&&(o=Math.max(s==null?void 0:s.bottom,o))}r=t.scrollDOM.clientHeight-n-o}else r=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:o,selfScroll:e,height:Math.max(t.defaultLineHeight,r-5)}}function Wr(t,e){let n=Nr(t),{state:o}=t,r=Oe(o.selection,s=>s.empty?t.moveVertically(s,e,n.height):Et(s,e));if(r.eq(o.selection))return!1;let i;if(n.selfScroll){let s=t.coordsAtPos(o.selection.main.head),l=t.scrollDOM.getBoundingClientRect(),a=l.top+n.marginTop,c=l.bottom-n.marginBottom;s&&s.top>a&&s.bottom<c&&(i=k.scrollIntoView(r.main.head,{y:"start",yMargin:s.top-a}))}return t.dispatch(ne(o,r),{effects:i}),!0}const ro=t=>Wr(t,!1),tn=t=>Wr(t,!0);function fe(t,e,n){let o=t.lineBlockAt(e.head),r=t.moveToLineBoundary(e,n);if(r.head==e.head&&r.head!=(n?o.to:o.from)&&(r=t.moveToLineBoundary(e,n,!1)),!n&&r.head==o.from&&o.length){let i=/^\s*/.exec(t.state.sliceDoc(o.from,Math.min(o.from+100,o.to)))[0].length;i&&e.head!=o.from+i&&(r=_.cursor(o.from+i))}return r}const Ys=t=>Q(t,e=>fe(t,e,!0)),Zs=t=>Q(t,e=>fe(t,e,!1)),Xs=t=>Q(t,e=>fe(t,e,!I(t))),el=t=>Q(t,e=>fe(t,e,I(t))),tl=t=>Q(t,e=>_.cursor(t.lineBlockAt(e.head).from,1)),nl=t=>Q(t,e=>_.cursor(t.lineBlockAt(e.head).to,-1));function ol(t,e,n){let o=!1,r=Oe(t.selection,i=>{let s=xe(t,i.head,-1)||xe(t,i.head,1)||i.head>0&&xe(t,i.head-1,1)||i.head<t.doc.length&&xe(t,i.head+1,-1);if(!s||!s.end)return i;o=!0;let l=s.start.from==i.head?s.end.to:s.end.from;return _.cursor(l)});return o?(e(ne(t,r)),!0):!1}const rl=({state:t,dispatch:e})=>ol(t,e);function G(t,e){let n=Oe(t.state.selection,o=>{let r=e(o);return _.range(o.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return n.eq(t.state.selection)?!1:(t.dispatch(ne(t.state,n)),!0)}function Fr(t,e){return G(t,n=>t.moveByChar(n,e))}const Ur=t=>Fr(t,!I(t)),Hr=t=>Fr(t,I(t));function Vr(t,e){return G(t,n=>t.moveByGroup(n,e))}const il=t=>Vr(t,!I(t)),sl=t=>Vr(t,I(t)),ll=t=>G(t,e=>Tt(t.state,e,!I(t))),al=t=>G(t,e=>Tt(t.state,e,I(t)));function zr(t,e){return G(t,n=>t.moveVertically(n,e))}const qr=t=>zr(t,!1),jr=t=>zr(t,!0);function Kr(t,e){return G(t,n=>t.moveVertically(n,e,Nr(t).height))}const io=t=>Kr(t,!1),so=t=>Kr(t,!0),cl=t=>G(t,e=>fe(t,e,!0)),ul=t=>G(t,e=>fe(t,e,!1)),fl=t=>G(t,e=>fe(t,e,!I(t))),hl=t=>G(t,e=>fe(t,e,I(t))),dl=t=>G(t,e=>_.cursor(t.lineBlockAt(e.head).from)),pl=t=>G(t,e=>_.cursor(t.lineBlockAt(e.head).to)),lo=({state:t,dispatch:e})=>(e(ne(t,{anchor:0})),!0),ao=({state:t,dispatch:e})=>(e(ne(t,{anchor:t.doc.length})),!0),co=({state:t,dispatch:e})=>(e(ne(t,{anchor:t.selection.main.anchor,head:0})),!0),uo=({state:t,dispatch:e})=>(e(ne(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0),ml=({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0),gl=({state:t,dispatch:e})=>{let n=Bt(t).map(({from:o,to:r})=>_.range(o,Math.min(r+1,t.doc.length)));return e(t.update({selection:_.create(n),userEvent:"select"})),!0},_l=({state:t,dispatch:e})=>{let n=Oe(t.selection,o=>{var r;let i=Be(t).resolveStack(o.from,1);for(let s=i;s;s=s.next){let{node:l}=s;if((l.from<o.from&&l.to>=o.to||l.to>o.to&&l.from<=o.from)&&(!((r=l.parent)===null||r===void 0)&&r.parent))return _.range(l.to,l.from)}return o});return e(ne(t,n)),!0},yl=({state:t,dispatch:e})=>{let n=t.selection,o=null;return n.ranges.length>1?o=_.create([n.main]):n.main.empty||(o=_.create([_.cursor(n.main.head)])),o?(e(ne(t,o)),!0):!1};function Ze(t,e){if(t.state.readOnly)return!1;let n="delete.selection",{state:o}=t,r=o.changeByRange(i=>{let{from:s,to:l}=i;if(s==l){let a=e(i);a<s?(n="delete.backward",a=ot(t,a,!1)):a>s&&(n="delete.forward",a=ot(t,a,!0)),s=Math.min(s,a),l=Math.max(l,a)}else s=ot(t,s,!1),l=ot(t,l,!0);return s==l?{range:i}:{changes:{from:s,to:l},range:_.cursor(s,s<i.head?-1:1)}});return r.changes.empty?!1:(t.dispatch(o.update(r,{scrollIntoView:!0,userEvent:n,effects:n=="delete.selection"?k.announce.of(o.phrase("Selection deleted")):void 0})),!0)}function ot(t,e,n){if(t instanceof k)for(let o of t.state.facet(k.atomicRanges).map(r=>r(t)))o.between(e,e,(r,i)=>{r<e&&i>e&&(e=n?i:r)});return e}const Gr=(t,e,n)=>Ze(t,o=>{let r=o.from,{state:i}=t,s=i.doc.lineAt(r),l,a;if(n&&!e&&r>s.from&&r<s.from+200&&!/[^ \t]/.test(l=s.text.slice(0,r-s.from))){if(l[l.length-1]=="	")return r-1;let c=an(l,i.tabSize),f=c%jt(i)||jt(i);for(let u=0;u<f&&l[l.length-1-u]==" ";u++)r--;a=r}else a=ge(s.text,r-s.from,e,e)+s.from,a==r&&s.number!=(e?i.doc.lines:1)?a+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(s.text.slice(a-s.from,r-s.from))&&(a=ge(s.text,a-s.from,!1,!1)+s.from);return a}),nn=t=>Gr(t,!1,!0),Jr=t=>Gr(t,!0,!1),Qr=(t,e)=>Ze(t,n=>{let o=n.head,{state:r}=t,i=r.doc.lineAt(o),s=r.charCategorizer(o);for(let l=null;;){if(o==(e?i.to:i.from)){o==n.head&&i.number!=(e?r.doc.lines:1)&&(o+=e?1:-1);break}let a=ge(i.text,o-i.from,e)+i.from,c=i.text.slice(Math.min(o,a)-i.from,Math.max(o,a)-i.from),f=s(c);if(l!=null&&f!=l)break;(c!=" "||o!=n.head)&&(l=f),o=a}return o}),Yr=t=>Qr(t,!1),bl=t=>Qr(t,!0),vl=t=>Ze(t,e=>{let n=t.lineBlockAt(e.head).to;return e.head<n?n:Math.min(t.state.doc.length,e.head+1)}),xl=t=>Ze(t,e=>{let n=t.moveToLineBoundary(e,!1).head;return e.head>n?n:Math.max(0,e.head-1)}),kl=t=>Ze(t,e=>{let n=t.moveToLineBoundary(e,!0).head;return e.head<n?n:Math.min(t.state.doc.length,e.head+1)}),Cl=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(o=>({changes:{from:o.from,to:o.to,insert:Po.of(["",""])},range:_.cursor(o.from)}));return e(t.update(n,{scrollIntoView:!0,userEvent:"input"})),!0},Sl=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(o=>{if(!o.empty||o.from==0||o.from==t.doc.length)return{range:o};let r=o.from,i=t.doc.lineAt(r),s=r==i.from?r-1:ge(i.text,r-i.from,!1)+i.from,l=r==i.to?r+1:ge(i.text,r-i.from,!0)+i.from;return{changes:{from:s,to:l,insert:t.doc.slice(r,l).append(t.doc.slice(s,r))},range:_.cursor(l)}});return n.changes.empty?!1:(e(t.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Bt(t){let e=[],n=-1;for(let o of t.selection.ranges){let r=t.doc.lineAt(o.from),i=t.doc.lineAt(o.to);if(!o.empty&&o.to==i.from&&(i=t.doc.lineAt(o.to-1)),n>=r.number){let s=e[e.length-1];s.to=i.to,s.ranges.push(o)}else e.push({from:r.from,to:i.to,ranges:[o]});n=i.number+1}return e}function Zr(t,e,n){if(t.readOnly)return!1;let o=[],r=[];for(let i of Bt(t)){if(n?i.to==t.doc.length:i.from==0)continue;let s=t.doc.lineAt(n?i.to+1:i.from-1),l=s.length+1;if(n){o.push({from:i.to,to:s.to},{from:i.from,insert:s.text+t.lineBreak});for(let a of i.ranges)r.push(_.range(Math.min(t.doc.length,a.anchor+l),Math.min(t.doc.length,a.head+l)))}else{o.push({from:s.from,to:i.from},{from:i.to,insert:t.lineBreak+s.text});for(let a of i.ranges)r.push(_.range(a.anchor-l,a.head-l))}}return o.length?(e(t.update({changes:o,scrollIntoView:!0,selection:_.create(r,t.selection.mainIndex),userEvent:"move.line"})),!0):!1}const Al=({state:t,dispatch:e})=>Zr(t,e,!1),wl=({state:t,dispatch:e})=>Zr(t,e,!0);function Xr(t,e,n){if(t.readOnly)return!1;let o=[];for(let r of Bt(t))n?o.push({from:r.from,insert:t.doc.slice(r.from,r.to)+t.lineBreak}):o.push({from:r.to,insert:t.lineBreak+t.doc.slice(r.from,r.to)});return e(t.update({changes:o,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const Ml=({state:t,dispatch:e})=>Xr(t,e,!1),Ll=({state:t,dispatch:e})=>Xr(t,e,!0),Dl=t=>{if(t.state.readOnly)return!1;let{state:e}=t,n=e.changes(Bt(e).map(({from:r,to:i})=>(r>0?r--:i<e.doc.length&&i++,{from:r,to:i}))),o=Oe(e.selection,r=>{let i;if(t.lineWrapping){let s=t.lineBlockAt(r.head),l=t.coordsAtPos(r.head,r.assoc||1);l&&(i=s.bottom+t.documentTop-l.bottom+t.defaultLineHeight/2)}return t.moveVertically(r,!0,i)}).map(n);return t.dispatch({changes:n,selection:o,scrollIntoView:!0,userEvent:"delete.line"}),!0};function El(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let n=Be(t).resolveInner(e),o=n.childBefore(e),r=n.childAfter(e),i;return o&&r&&o.to<=e&&r.from>=e&&(i=o.type.prop(qt.closedBy))&&i.indexOf(r.name)>-1&&t.doc.lineAt(o.to).from==t.doc.lineAt(r.from).from&&!/\S/.test(t.sliceDoc(o.to,r.from))?{from:o.to,to:r.from}:null}const Tl=ei(!1),Bl=ei(!0);function ei(t){return({state:e,dispatch:n})=>{if(e.readOnly)return!1;let o=e.changeByRange(r=>{let{from:i,to:s}=r,l=e.doc.lineAt(i),a=!t&&i==s&&El(e,i);t&&(i=s=(s<=l.to?l:e.doc.lineAt(s)).to);let c=new Ro(e,{simulateBreak:i,simulateDoubleBreak:!!a}),f=Io(c,i);for(f==null&&(f=an(/^\s*/.exec(e.doc.lineAt(i).text)[0],e.tabSize));s<l.to&&/\s/.test(l.text[s-l.from]);)s++;a?{from:i,to:s}=a:i>l.from&&i<l.from+100&&!/\S/.test(l.text.slice(0,i))&&(i=l.from);let u=["",ut(e,f)];return a&&u.push(ut(e,c.lineIndent(l.from,-1))),{changes:{from:i,to:s,insert:Po.of(u)},range:_.cursor(i+1+u[1].length)}});return n(e.update(o,{scrollIntoView:!0,userEvent:"input"})),!0}}function En(t,e){let n=-1;return t.changeByRange(o=>{let r=[];for(let s=o.from;s<=o.to;){let l=t.doc.lineAt(s);l.number>n&&(o.empty||o.to>l.from)&&(e(l,r,o),n=l.number),s=l.to+1}let i=t.changes(r);return{changes:r,range:_.range(i.mapPos(o.anchor,1),i.mapPos(o.head,1))}})}const Ol=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=Object.create(null),o=new Ro(t,{overrideIndentation:i=>{let s=n[i];return s??-1}}),r=En(t,(i,s,l)=>{let a=Io(o,i.from);if(a==null)return;/\S/.test(i.text)||(a=0);let c=/^\s*/.exec(i.text)[0],f=ut(t,a);(c!=f||l.from<i.from+c.length)&&(n[i.from]=a,s.push({from:i.from,to:i.from+c.length,insert:f}))});return r.changes.empty||e(t.update(r,{userEvent:"indent"})),!0},ti=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(En(t,(n,o)=>{o.push({from:n.from,insert:t.facet(No)})}),{userEvent:"input.indent"})),!0),ni=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(En(t,(n,o)=>{let r=/^\s*/.exec(n.text)[0];if(!r)return;let i=an(r,t.tabSize),s=0,l=ut(t,Math.max(0,i-jt(t)));for(;s<r.length&&s<l.length&&r.charCodeAt(s)==l.charCodeAt(s);)s++;o.push({from:n.from+s,to:n.from+r.length,insert:l.slice(s)})}),{userEvent:"delete.dedent"})),!0),Rl=t=>(t.setTabFocusMode(),!0),Il=[{key:"Ctrl-b",run:Br,shift:Ur,preventDefault:!0},{key:"Ctrl-f",run:Or,shift:Hr},{key:"Ctrl-p",run:Pr,shift:qr},{key:"Ctrl-n",run:$r,shift:jr},{key:"Ctrl-a",run:tl,shift:dl},{key:"Ctrl-e",run:nl,shift:pl},{key:"Ctrl-d",run:Jr},{key:"Ctrl-h",run:nn},{key:"Ctrl-k",run:vl},{key:"Ctrl-Alt-h",run:Yr},{key:"Ctrl-o",run:Cl},{key:"Ctrl-t",run:Sl},{key:"Ctrl-v",run:tn}],Pl=[{key:"ArrowLeft",run:Br,shift:Ur,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:js,shift:il,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Xs,shift:fl,preventDefault:!0},{key:"ArrowRight",run:Or,shift:Hr,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Ks,shift:sl,preventDefault:!0},{mac:"Cmd-ArrowRight",run:el,shift:hl,preventDefault:!0},{key:"ArrowUp",run:Pr,shift:qr,preventDefault:!0},{mac:"Cmd-ArrowUp",run:lo,shift:co},{mac:"Ctrl-ArrowUp",run:ro,shift:io},{key:"ArrowDown",run:$r,shift:jr,preventDefault:!0},{mac:"Cmd-ArrowDown",run:ao,shift:uo},{mac:"Ctrl-ArrowDown",run:tn,shift:so},{key:"PageUp",run:ro,shift:io},{key:"PageDown",run:tn,shift:so},{key:"Home",run:Zs,shift:ul,preventDefault:!0},{key:"Mod-Home",run:lo,shift:co},{key:"End",run:Ys,shift:cl,preventDefault:!0},{key:"Mod-End",run:ao,shift:uo},{key:"Enter",run:Tl},{key:"Mod-a",run:ml},{key:"Backspace",run:nn,shift:nn},{key:"Delete",run:Jr},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Yr},{key:"Mod-Delete",mac:"Alt-Delete",run:bl},{mac:"Mod-Backspace",run:xl},{mac:"Mod-Delete",run:kl}].concat(Il.map(t=>({mac:t.key,run:t.run,shift:t.shift}))),$l=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Js,shift:ll},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Qs,shift:al},{key:"Alt-ArrowUp",run:Al},{key:"Shift-Alt-ArrowUp",run:Ml},{key:"Alt-ArrowDown",run:wl},{key:"Shift-Alt-ArrowDown",run:Ll},{key:"Escape",run:yl},{key:"Mod-Enter",run:Bl},{key:"Alt-l",mac:"Ctrl-l",run:gl},{key:"Mod-i",run:_l,preventDefault:!0},{key:"Mod-[",run:ni},{key:"Mod-]",run:ti},{key:"Mod-Alt-\\",run:Ol},{key:"Shift-Mod-k",run:Dl},{key:"Shift-Mod-\\",run:rl},{key:"Mod-/",run:Ms},{key:"Alt-A",run:Ds},{key:"Ctrl-m",mac:"Shift-Alt-m",run:Rl}].concat(Pl),Nl={key:"Tab",run:ti,shift:ni};function S(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,n=arguments[1];if(n&&typeof n=="object"&&n.nodeType==null&&!Array.isArray(n)){for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o)){var r=n[o];typeof r=="string"?t.setAttribute(o,r):r!=null&&(t[o]=r)}e++}for(;e<arguments.length;e++)oi(t,arguments[e]);return t}function oi(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var n=0;n<e.length;n++)oi(t,e[n]);else throw new RangeError("Unsupported child node: "+e)}const fo=typeof String.prototype.normalize=="function"?t=>t.normalize("NFKD"):t=>t;class Le{constructor(e,n,o=0,r=e.length,i,s){this.test=s,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(o,r),this.bufferStart=o,this.normalize=i?l=>i(fo(l)):fo,this.query=this.normalize(n)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return j(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let n=fn(e),o=this.bufferStart+this.bufferPos;this.bufferPos+=re(e);let r=this.normalize(n);for(let i=0,s=o;;i++){let l=r.charCodeAt(i),a=this.match(l,s,this.bufferPos+this.bufferStart);if(i==r.length-1){if(a)return this.value=a,this;break}s==o&&i<n.length&&n.charCodeAt(i)==l&&s++}}}match(e,n,o){let r=null;for(let i=0;i<this.matches.length;i+=2){let s=this.matches[i],l=!1;this.query.charCodeAt(s)==e&&(s==this.query.length-1?r={from:this.matches[i+1],to:o}:(this.matches[i]++,l=!0)),l||(this.matches.splice(i,2),i-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?r={from:n,to:o}:this.matches.push(1,n)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferStart)&&(r=null),r}}typeof Symbol<"u"&&(Le.prototype[Symbol.iterator]=function(){return this});const ri={from:-1,to:-1,match:/.*/.exec("")},Tn="gm"+(/x/.unicode==null?"":"u");class ii{constructor(e,n,o,r=0,i=e.length){if(this.text=e,this.to=i,this.curLine="",this.done=!1,this.value=ri,/\\[sWDnr]|\n|\r|\[\^/.test(n))return new si(e,n,o,r,i);this.re=new RegExp(n,Tn+(o!=null&&o.ignoreCase?"i":"")),this.test=o==null?void 0:o.test,this.iter=e.iter();let s=e.lineAt(r);this.curLineStart=s.from,this.matchPos=mt(e,r),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let n=this.matchPos<=this.to&&this.re.exec(this.curLine);if(n){let o=this.curLineStart+n.index,r=o+n[0].length;if(this.matchPos=mt(this.text,r+(o==r?1:0)),o==this.curLineStart+this.curLine.length&&this.nextLine(),(o<r||o>this.value.to)&&(!this.test||this.test(o,r,n)))return this.value={from:o,to:r,match:n},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const Ft=new WeakMap;class Se{constructor(e,n){this.from=e,this.text=n}get to(){return this.from+this.text.length}static get(e,n,o){let r=Ft.get(e);if(!r||r.from>=o||r.to<=n){let l=new Se(n,e.sliceString(n,o));return Ft.set(e,l),l}if(r.from==n&&r.to==o)return r;let{text:i,from:s}=r;return s>n&&(i=e.sliceString(n,s)+i,s=n),r.to<o&&(i+=e.sliceString(r.to,o)),Ft.set(e,new Se(s,i)),new Se(n,i.slice(n-s,o-s))}}class si{constructor(e,n,o,r,i){this.text=e,this.to=i,this.done=!1,this.value=ri,this.matchPos=mt(e,r),this.re=new RegExp(n,Tn+(o!=null&&o.ignoreCase?"i":"")),this.test=o==null?void 0:o.test,this.flat=Se.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,n=this.re.exec(this.flat.text);if(n&&!n[0]&&n.index==e&&(this.re.lastIndex=e+1,n=this.re.exec(this.flat.text)),n){let o=this.flat.from+n.index,r=o+n[0].length;if((this.flat.to>=this.to||n.index+n[0].length<=this.flat.text.length-10)&&(!this.test||this.test(o,r,n)))return this.value={from:o,to:r,match:n},this.matchPos=mt(this.text,r+(o==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Se.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(ii.prototype[Symbol.iterator]=si.prototype[Symbol.iterator]=function(){return this});function Wl(t){try{return new RegExp(t,Tn),!0}catch{return!1}}function mt(t,e){if(e>=t.length)return e;let n=t.lineAt(e),o;for(;e<n.to&&(o=n.text.charCodeAt(e-n.from))>=56320&&o<57344;)e++;return e}function on(t){let e=String(t.state.doc.lineAt(t.state.selection.main.head).number),n=S("input",{class:"cm-textfield",name:"line",value:e}),o=S("form",{class:"cm-gotoLine",onkeydown:i=>{i.keyCode==27?(i.preventDefault(),t.dispatch({effects:gt.of(!1)}),t.focus()):i.keyCode==13&&(i.preventDefault(),r())},onsubmit:i=>{i.preventDefault(),r()}},S("label",t.state.phrase("Go to line"),": ",n)," ",S("button",{class:"cm-button",type:"submit"},t.state.phrase("go")));function r(){let i=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(n.value);if(!i)return;let{state:s}=t,l=s.doc.lineAt(s.selection.main.head),[,a,c,f,u]=i,h=f?+f.slice(1):0,d=c?+c:l.number;if(c&&u){let x=d/100;a&&(x=x*(a=="-"?-1:1)+l.number/s.doc.lines),d=Math.round(s.doc.lines*x)}else c&&a&&(d=d*(a=="-"?-1:1)+l.number);let m=s.doc.line(Math.max(1,Math.min(s.doc.lines,d))),v=_.cursor(m.from+Math.max(0,Math.min(h,m.length)));t.dispatch({effects:[gt.of(!1),k.scrollIntoView(v.from,{y:"center"})],selection:v}),t.focus()}return{dom:o}}const gt=O.define(),ho=Ee.define({create(){return!0},update(t,e){for(let n of e.effects)n.is(gt)&&(t=n.value);return t},provide:t=>un.from(t,e=>e?on:null)}),Fl=t=>{let e=We(t,on);if(!e){let n=[gt.of(!0)];t.state.field(ho,!1)==null&&n.push(O.appendConfig.of([ho,Ul])),t.dispatch({effects:n}),e=We(t,on)}return e&&e.dom.querySelector("input").select(),!0},Ul=k.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),Hl={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},Vl=Te.define({combine(t){return Ke(t,Hl,{highlightWordAroundCursor:(e,n)=>e||n,minSelectionLength:Math.min,maxMatches:Math.min})}});function zl(t){return[Jl,Gl]}const ql=D.mark({class:"cm-selectionMatch"}),jl=D.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function po(t,e,n,o){return(n==0||t(e.sliceDoc(n-1,n))!=P.Word)&&(o==e.doc.length||t(e.sliceDoc(o,o+1))!=P.Word)}function Kl(t,e,n,o){return t(e.sliceDoc(n,n+1))==P.Word&&t(e.sliceDoc(o-1,o))==P.Word}const Gl=St.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.selectionSet||t.docChanged||t.viewportChanged)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=t.state.facet(Vl),{state:n}=t,o=n.selection;if(o.ranges.length>1)return D.none;let r=o.main,i,s=null;if(r.empty){if(!e.highlightWordAroundCursor)return D.none;let a=n.wordAt(r.head);if(!a)return D.none;s=n.charCategorizer(r.head),i=n.sliceDoc(a.from,a.to)}else{let a=r.to-r.from;if(a<e.minSelectionLength||a>200)return D.none;if(e.wholeWords){if(i=n.sliceDoc(r.from,r.to),s=n.charCategorizer(r.head),!(po(s,n,r.from,r.to)&&Kl(s,n,r.from,r.to)))return D.none}else if(i=n.sliceDoc(r.from,r.to),!i)return D.none}let l=[];for(let a of t.visibleRanges){let c=new Le(n.doc,i,a.from,a.to);for(;!c.next().done;){let{from:f,to:u}=c.value;if((!s||po(s,n,f,u))&&(r.empty&&f<=r.from&&u>=r.to?l.push(jl.range(f,u)):(f>=r.to||u<=r.from)&&l.push(ql.range(f,u)),l.length>e.maxMatches))return D.none}}return D.set(l)}},{decorations:t=>t.decorations}),Jl=k.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),Ql=({state:t,dispatch:e})=>{let{selection:n}=t,o=_.create(n.ranges.map(r=>t.wordAt(r.head)||_.cursor(r.head)),n.mainIndex);return o.eq(n)?!1:(e(t.update({selection:o})),!0)};function Yl(t,e){let{main:n,ranges:o}=t.selection,r=t.wordAt(n.head),i=r&&r.from==n.from&&r.to==n.to;for(let s=!1,l=new Le(t.doc,e,o[o.length-1].to);;)if(l.next(),l.done){if(s)return null;l=new Le(t.doc,e,0,Math.max(0,o[o.length-1].from-1)),s=!0}else{if(s&&o.some(a=>a.from==l.value.from))continue;if(i){let a=t.wordAt(l.value.from);if(!a||a.from!=l.value.from||a.to!=l.value.to)continue}return l.value}}const Zl=({state:t,dispatch:e})=>{let{ranges:n}=t.selection;if(n.some(i=>i.from===i.to))return Ql({state:t,dispatch:e});let o=t.sliceDoc(n[0].from,n[0].to);if(t.selection.ranges.some(i=>t.sliceDoc(i.from,i.to)!=o))return!1;let r=Yl(t,o);return r?(e(t.update({selection:t.selection.addRange(_.range(r.from,r.to),!1),effects:k.scrollIntoView(r.to)})),!0):!1},Re=Te.define({combine(t){return Ke(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new ua(e),scrollToMatch:e=>k.scrollIntoView(e)})}});class li{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||Wl(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(n,o)=>o=="n"?`
`:o=="r"?"\r":o=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new na(this):new ea(this)}getCursor(e,n=0,o){let r=e.doc?e:Fe.create({doc:e});return o==null&&(o=r.doc.length),this.regexp?ve(this,r,n,o):be(this,r,n,o)}}class ai{constructor(e){this.spec=e}}function be(t,e,n,o){return new Le(e.doc,t.unquoted,n,o,t.caseSensitive?void 0:r=>r.toLowerCase(),t.wholeWord?Xl(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function Xl(t,e){return(n,o,r,i)=>((i>n||i+r.length<o)&&(i=Math.max(0,n-2),r=t.sliceString(i,Math.min(t.length,o+2))),(e(_t(r,n-i))!=P.Word||e(yt(r,n-i))!=P.Word)&&(e(yt(r,o-i))!=P.Word||e(_t(r,o-i))!=P.Word))}class ea extends ai{constructor(e){super(e)}nextMatch(e,n,o){let r=be(this.spec,e,o,e.doc.length).nextOverlapping();return r.done&&(r=be(this.spec,e,0,n).nextOverlapping()),r.done?null:r.value}prevMatchInRange(e,n,o){for(let r=o;;){let i=Math.max(n,r-1e4-this.spec.unquoted.length),s=be(this.spec,e,i,r),l=null;for(;!s.nextOverlapping().done;)l=s.value;if(l)return l;if(i==n)return null;r-=1e4}}prevMatch(e,n,o){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,o,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,n){let o=be(this.spec,e,0,e.doc.length),r=[];for(;!o.next().done;){if(r.length>=n)return null;r.push(o.value)}return r}highlight(e,n,o,r){let i=be(this.spec,e,Math.max(0,n-this.spec.unquoted.length),Math.min(o+this.spec.unquoted.length,e.doc.length));for(;!i.next().done;)r(i.value.from,i.value.to)}}function ve(t,e,n,o){return new ii(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?ta(e.charCategorizer(e.selection.main.head)):void 0},n,o)}function _t(t,e){return t.slice(ge(t,e,!1),e)}function yt(t,e){return t.slice(e,ge(t,e))}function ta(t){return(e,n,o)=>!o[0].length||(t(_t(o.input,o.index))!=P.Word||t(yt(o.input,o.index))!=P.Word)&&(t(yt(o.input,o.index+o[0].length))!=P.Word||t(_t(o.input,o.index+o[0].length))!=P.Word)}class na extends ai{nextMatch(e,n,o){let r=ve(this.spec,e,o,e.doc.length).next();return r.done&&(r=ve(this.spec,e,0,n).next()),r.done?null:r.value}prevMatchInRange(e,n,o){for(let r=1;;r++){let i=Math.max(n,o-r*1e4),s=ve(this.spec,e,i,o),l=null;for(;!s.next().done;)l=s.value;if(l&&(i==n||l.from>i+10))return l;if(i==n)return null}}prevMatch(e,n,o){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,o,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(n,o)=>o=="$"?"$":o=="&"?e.match[0]:o!="0"&&+o<e.match.length?e.match[o]:n)}matchAll(e,n){let o=ve(this.spec,e,0,e.doc.length),r=[];for(;!o.next().done;){if(r.length>=n)return null;r.push(o.value)}return r}highlight(e,n,o,r){let i=ve(this.spec,e,Math.max(0,n-250),Math.min(o+250,e.doc.length));for(;!i.next().done;)r(i.value.from,i.value.to)}}const Ve=O.define(),Bn=O.define(),ce=Ee.define({create(t){return new Ut(rn(t).create(),null)},update(t,e){for(let n of e.effects)n.is(Ve)?t=new Ut(n.value.create(),t.panel):n.is(Bn)&&(t=new Ut(t.query,n.value?On:null));return t},provide:t=>un.from(t,e=>e.panel)});class Ut{constructor(e,n){this.query=e,this.panel=n}}const oa=D.mark({class:"cm-searchMatch"}),ra=D.mark({class:"cm-searchMatch cm-searchMatch-selected"}),ia=St.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(ce))}update(t){let e=t.state.field(ce);(e!=t.startState.field(ce)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return D.none;let{view:n}=this,o=new Bi;for(let r=0,i=n.visibleRanges,s=i.length;r<s;r++){let{from:l,to:a}=i[r];for(;r<s-1&&a>i[r+1].from-2*250;)a=i[++r].to;t.highlight(n.state,l,a,(c,f)=>{let u=n.state.selection.ranges.some(h=>h.from==c&&h.to==f);o.add(c,f,u?ra:oa)})}return o.finish()}},{decorations:t=>t.decorations});function Xe(t){return e=>{let n=e.state.field(ce,!1);return n&&n.query.spec.valid?t(e,n):fi(e)}}const bt=Xe((t,{query:e})=>{let{to:n}=t.state.selection.main,o=e.nextMatch(t.state,n,n);if(!o)return!1;let r=_.single(o.from,o.to),i=t.state.facet(Re);return t.dispatch({selection:r,effects:[Rn(t,o),i.scrollToMatch(r.main,t)],userEvent:"select.search"}),ui(t),!0}),vt=Xe((t,{query:e})=>{let{state:n}=t,{from:o}=n.selection.main,r=e.prevMatch(n,o,o);if(!r)return!1;let i=_.single(r.from,r.to),s=t.state.facet(Re);return t.dispatch({selection:i,effects:[Rn(t,r),s.scrollToMatch(i.main,t)],userEvent:"select.search"}),ui(t),!0}),sa=Xe((t,{query:e})=>{let n=e.matchAll(t.state,1e3);return!n||!n.length?!1:(t.dispatch({selection:_.create(n.map(o=>_.range(o.from,o.to))),userEvent:"select.search.matches"}),!0)}),la=({state:t,dispatch:e})=>{let n=t.selection;if(n.ranges.length>1||n.main.empty)return!1;let{from:o,to:r}=n.main,i=[],s=0;for(let l=new Le(t.doc,t.sliceDoc(o,r));!l.next().done;){if(i.length>1e3)return!1;l.value.from==o&&(s=i.length),i.push(_.range(l.value.from,l.value.to))}return e(t.update({selection:_.create(i,s),userEvent:"select.search.matches"})),!0},mo=Xe((t,{query:e})=>{let{state:n}=t,{from:o,to:r}=n.selection.main;if(n.readOnly)return!1;let i=e.nextMatch(n,o,o);if(!i)return!1;let s=[],l,a,c=[];if(i.from==o&&i.to==r&&(a=n.toText(e.getReplacement(i)),s.push({from:i.from,to:i.to,insert:a}),i=e.nextMatch(n,i.from,i.to),c.push(k.announce.of(n.phrase("replaced match on line $",n.doc.lineAt(o).number)+"."))),i){let f=s.length==0||s[0].from>=i.to?0:i.to-i.from-a.length;l=_.single(i.from-f,i.to-f),c.push(Rn(t,i)),c.push(n.facet(Re).scrollToMatch(l.main,t))}return t.dispatch({changes:s,selection:l,effects:c,userEvent:"input.replace"}),!0}),aa=Xe((t,{query:e})=>{if(t.state.readOnly)return!1;let n=e.matchAll(t.state,1e9).map(r=>{let{from:i,to:s}=r;return{from:i,to:s,insert:e.getReplacement(r)}});if(!n.length)return!1;let o=t.state.phrase("replaced $ matches",n.length)+".";return t.dispatch({changes:n,effects:k.announce.of(o),userEvent:"input.replace.all"}),!0});function On(t){return t.state.facet(Re).createPanel(t)}function rn(t,e){var n,o,r,i,s;let l=t.selection.main,a=l.empty||l.to>l.from+100?"":t.sliceDoc(l.from,l.to);if(e&&!a)return e;let c=t.facet(Re);return new li({search:((n=e==null?void 0:e.literal)!==null&&n!==void 0?n:c.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:(o=e==null?void 0:e.caseSensitive)!==null&&o!==void 0?o:c.caseSensitive,literal:(r=e==null?void 0:e.literal)!==null&&r!==void 0?r:c.literal,regexp:(i=e==null?void 0:e.regexp)!==null&&i!==void 0?i:c.regexp,wholeWord:(s=e==null?void 0:e.wholeWord)!==null&&s!==void 0?s:c.wholeWord})}function ci(t){let e=We(t,On);return e&&e.dom.querySelector("[main-field]")}function ui(t){let e=ci(t);e&&e==t.root.activeElement&&e.select()}const fi=t=>{let e=t.state.field(ce,!1);if(e&&e.panel){let n=ci(t);if(n&&n!=t.root.activeElement){let o=rn(t.state,e.query.spec);o.valid&&t.dispatch({effects:Ve.of(o)}),n.focus(),n.select()}}else t.dispatch({effects:[Bn.of(!0),e?Ve.of(rn(t.state,e.query.spec)):O.appendConfig.of(ha)]});return!0},hi=t=>{let e=t.state.field(ce,!1);if(!e||!e.panel)return!1;let n=We(t,On);return n&&n.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:Bn.of(!1)}),!0},ca=[{key:"Mod-f",run:fi,scope:"editor search-panel"},{key:"F3",run:bt,shift:vt,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:bt,shift:vt,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:hi,scope:"editor search-panel"},{key:"Mod-Shift-l",run:la},{key:"Mod-Alt-g",run:Fl},{key:"Mod-d",run:Zl,preventDefault:!0}];class ua{constructor(e){this.view=e;let n=this.query=e.state.field(ce).query.spec;this.commit=this.commit.bind(this),this.searchField=S("input",{value:n.search,placeholder:U(e,"Find"),"aria-label":U(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=S("input",{value:n.replace,placeholder:U(e,"Replace"),"aria-label":U(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=S("input",{type:"checkbox",name:"case",form:"",checked:n.caseSensitive,onchange:this.commit}),this.reField=S("input",{type:"checkbox",name:"re",form:"",checked:n.regexp,onchange:this.commit}),this.wordField=S("input",{type:"checkbox",name:"word",form:"",checked:n.wholeWord,onchange:this.commit});function o(r,i,s){return S("button",{class:"cm-button",name:r,onclick:i,type:"button"},s)}this.dom=S("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,o("next",()=>bt(e),[U(e,"next")]),o("prev",()=>vt(e),[U(e,"previous")]),o("select",()=>sa(e),[U(e,"all")]),S("label",null,[this.caseField,U(e,"match case")]),S("label",null,[this.reField,U(e,"regexp")]),S("label",null,[this.wordField,U(e,"by word")]),...e.state.readOnly?[]:[S("br"),this.replaceField,o("replace",()=>mo(e),[U(e,"replace")]),o("replaceAll",()=>aa(e),[U(e,"replace all")])],S("button",{name:"close",onclick:()=>hi(e),"aria-label":U(e,"close"),type:"button"},["×"])])}commit(){let e=new li({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Ve.of(e)}))}keydown(e){Oi(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?vt:bt)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),mo(this.view))}update(e){for(let n of e.transactions)for(let o of n.effects)o.is(Ve)&&!o.value.eq(this.query)&&this.setQuery(o.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Re).top}}function U(t,e){return t.state.phrase(e)}const rt=30,it=/[\s\.,:;?!]/;function Rn(t,{from:e,to:n}){let o=t.state.doc.lineAt(e),r=t.state.doc.lineAt(n).to,i=Math.max(o.from,e-rt),s=Math.min(r,n+rt),l=t.state.sliceDoc(i,s);if(i!=o.from){for(let a=0;a<rt;a++)if(!it.test(l[a+1])&&it.test(l[a])){l=l.slice(a);break}}if(s!=r){for(let a=l.length-1;a>l.length-rt;a--)if(!it.test(l[a-1])&&it.test(l[a])){l=l.slice(0,a);break}}return k.announce.of(`${t.state.phrase("current match")}. ${l} ${t.state.phrase("on line")} ${o.number}.`)}const fa=k.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),ha=[ce,cn.low(ia),fa];class di{constructor(e,n,o,r){this.state=e,this.pos=n,this.explicit=o,this.view=r,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let n=Be(this.state).resolveInner(this.pos,-1);for(;n&&e.indexOf(n.name)<0;)n=n.parent;return n?{from:n.from,to:this.pos,text:this.state.sliceDoc(n.from,this.pos),type:n.type}:null}matchBefore(e){let n=this.state.doc.lineAt(this.pos),o=Math.max(n.from,this.pos-250),r=n.text.slice(o-n.from,this.pos-n.from),i=r.search(pi(e,!1));return i<0?null:{from:o+i,to:this.pos,text:r.slice(i)}}get aborted(){return this.abortListeners==null}addEventListener(e,n,o){e=="abort"&&this.abortListeners&&(this.abortListeners.push(n),o&&o.onDocChange&&(this.abortOnDocChange=!0))}}function go(t){let e=Object.keys(t).join(""),n=/\w/.test(e);return n&&(e=e.replace(/\w/g,"")),`[${n?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function da(t){let e=Object.create(null),n=Object.create(null);for(let{label:r}of t){e[r[0]]=!0;for(let i=1;i<r.length;i++)n[r[i]]=!0}let o=go(e)+go(n)+"*$";return[new RegExp("^"+o),new RegExp(o)]}function pa(t){let e=t.map(r=>typeof r=="string"?{label:r}:r),[n,o]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:da(e);return r=>{let i=r.matchBefore(o);return i||r.explicit?{from:i?i.from:r.pos,options:e,validFor:n}:null}}class _o{constructor(e,n,o,r){this.completion=e,this.source=n,this.match=o,this.score=r}}function ue(t){return t.selection.main.from}function pi(t,e){var n;let{source:o}=t,r=e&&o[0]!="^",i=o[o.length-1]!="$";return!r&&!i?t:new RegExp(`${r?"^":""}(?:${o})${i?"$":""}`,(n=t.flags)!==null&&n!==void 0?n:t.ignoreCase?"i":"")}const mi=Ct.define();function ma(t,e,n,o){let{main:r}=t.selection,i=n-r.from,s=o-r.from;return Object.assign(Object.assign({},t.changeByRange(l=>l!=r&&n!=o&&t.sliceDoc(l.from+i,l.from+s)!=t.sliceDoc(n,o)?{range:l}:{changes:{from:l.from+i,to:o==r.from?l.to:l.from+s,insert:e},range:_.cursor(l.from+i+e.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const yo=new WeakMap;function ga(t){if(!Array.isArray(t))return t;let e=yo.get(t);return e||yo.set(t,e=pa(t)),e}const xt=O.define(),ze=O.define();class _a{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let n=0;n<e.length;){let o=j(e,n),r=re(o);this.chars.push(o);let i=e.slice(n,n+r),s=i.toUpperCase();this.folded.push(j(s==i?i.toLowerCase():s,0)),n+=r}this.astral=e.length!=this.chars.length}ret(e,n){return this.score=e,this.matched=n,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:n,folded:o,any:r,precise:i,byWord:s}=this;if(n.length==1){let p=j(e,0),E=re(p),w=E==e.length?0:-100;if(p!=n[0])if(p==o[0])w+=-200;else return null;return this.ret(w,[0,E])}let l=e.indexOf(this.pattern);if(l==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=n.length,c=0;if(l<0){for(let p=0,E=Math.min(e.length,200);p<E&&c<a;){let w=j(e,p);(w==n[c]||w==o[c])&&(r[c++]=p),p+=re(w)}if(c<a)return null}let f=0,u=0,h=!1,d=0,m=-1,v=-1,x=/[a-z]/.test(e),b=!0;for(let p=0,E=Math.min(e.length,200),w=0;p<E&&u<a;){let M=j(e,p);l<0&&(f<a&&M==n[f]&&(i[f++]=p),d<a&&(M==n[d]||M==o[d]?(d==0&&(m=p),v=p+1,d++):d=0));let R,F=M<255?M>=48&&M<=57||M>=97&&M<=122?2:M>=65&&M<=90?1:0:(R=fn(M))!=R.toLowerCase()?1:R!=R.toUpperCase()?2:0;(!p||F==1&&x||w==0&&F!=0)&&(n[u]==M||o[u]==M&&(h=!0)?s[u++]=p:s.length&&(b=!1)),w=F,p+=re(M)}return u==a&&s[0]==0&&b?this.result(-100+(h?-200:0),s,e):d==a&&m==0?this.ret(-200-e.length+(v==e.length?0:-100),[0,v]):l>-1?this.ret(-700-e.length,[l,l+this.pattern.length]):d==a?this.ret(-900-e.length,[m,v]):u==a?this.result(-100+(h?-200:0)+-700+(b?0:-1100),s,e):n.length==2?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,n,o){let r=[],i=0;for(let s of n){let l=s+(this.astral?re(j(o,s)):1);i&&r[i-1]==s?r[i-1]=l:(r[i++]=s,r[i++]=l)}return this.ret(e-o.length,r)}}class ya{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let n=e.slice(0,this.pattern.length),o=n==this.pattern?0:n.toLowerCase()==this.folded?-200:null;return o==null?null:(this.matched=[0,n.length],this.score=o+(e.length==this.pattern.length?0:-100),this)}}const B=Te.define({combine(t){return Ke(t,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:ba,filterStrict:!1,compareCompletions:(e,n)=>e.label.localeCompare(n.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,n)=>e&&n,closeOnBlur:(e,n)=>e&&n,icons:(e,n)=>e&&n,tooltipClass:(e,n)=>o=>bo(e(o),n(o)),optionClass:(e,n)=>o=>bo(e(o),n(o)),addToOptions:(e,n)=>e.concat(n),filterStrict:(e,n)=>e||n})}});function bo(t,e){return t?e?t+" "+e:t:e}function ba(t,e,n,o,r,i){let s=t.textDirection==$o.RTL,l=s,a=!1,c="top",f,u,h=e.left-r.left,d=r.right-e.right,m=o.right-o.left,v=o.bottom-o.top;if(l&&h<Math.min(m,d)?l=!1:!l&&d<Math.min(m,h)&&(l=!0),m<=(l?h:d))f=Math.max(r.top,Math.min(n.top,r.bottom-v))-e.top,u=Math.min(400,l?h:d);else{a=!0,u=Math.min(400,(s?e.right:r.right-e.left)-30);let p=r.bottom-e.bottom;p>=v||p>e.top?f=n.bottom-e.top:(c="bottom",f=e.bottom-n.top)}let x=(e.bottom-e.top)/i.offsetHeight,b=(e.right-e.left)/i.offsetWidth;return{style:`${c}: ${f/x}px; max-width: ${u/b}px`,class:"cm-completionInfo-"+(a?s?"left-narrow":"right-narrow":l?"left":"right")}}function va(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(n){let o=document.createElement("div");return o.classList.add("cm-completionIcon"),n.type&&o.classList.add(...n.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),o.setAttribute("aria-hidden","true"),o},position:20}),e.push({render(n,o,r,i){let s=document.createElement("span");s.className="cm-completionLabel";let l=n.displayLabel||n.label,a=0;for(let c=0;c<i.length;){let f=i[c++],u=i[c++];f>a&&s.appendChild(document.createTextNode(l.slice(a,f)));let h=s.appendChild(document.createElement("span"));h.appendChild(document.createTextNode(l.slice(f,u))),h.className="cm-completionMatchedText",a=u}return a<l.length&&s.appendChild(document.createTextNode(l.slice(a))),s},position:50},{render(n){if(!n.detail)return null;let o=document.createElement("span");return o.className="cm-completionDetail",o.textContent=n.detail,o},position:80}),e.sort((n,o)=>n.position-o.position).map(n=>n.render)}function Ht(t,e,n){if(t<=n)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let r=Math.floor(e/n);return{from:r*n,to:(r+1)*n}}let o=Math.floor((t-e)/n);return{from:t-(o+1)*n,to:t-o*n}}class xa{constructor(e,n,o){this.view=e,this.stateField=n,this.applyCompletion=o,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:a=>this.placeInfo(a),key:this},this.space=null,this.currentClass="";let r=e.state.field(n),{options:i,selected:s}=r.open,l=e.state.facet(B);this.optionContent=va(l),this.optionClass=l.optionClass,this.tooltipClass=l.tooltipClass,this.range=Ht(i.length,s,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",a=>{let{options:c}=e.state.field(n).open;for(let f=a.target,u;f&&f!=this.dom;f=f.parentNode)if(f.nodeName=="LI"&&(u=/-(\d+)$/.exec(f.id))&&+u[1]<c.length){this.applyCompletion(e,c[+u[1]]),a.preventDefault();return}}),this.dom.addEventListener("focusout",a=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(B).closeOnBlur&&a.relatedTarget!=e.contentDOM&&e.dispatch({effects:ze.of(null)})}),this.showOptions(i,r.id)}mount(){this.updateSel()}showOptions(e,n){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,n,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var n;let o=e.state.field(this.stateField),r=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),o!=r){let{options:i,selected:s,disabled:l}=o.open;(!r.open||r.open.options!=i)&&(this.range=Ht(i.length,s,e.state.facet(B).maxRenderedOptions),this.showOptions(i,o.id)),this.updateSel(),l!=((n=r.open)===null||n===void 0?void 0:n.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!l)}}updateTooltipClass(e){let n=this.tooltipClass(e);if(n!=this.currentClass){for(let o of this.currentClass.split(" "))o&&this.dom.classList.remove(o);for(let o of n.split(" "))o&&this.dom.classList.add(o);this.currentClass=n}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),n=e.open;if((n.selected>-1&&n.selected<this.range.from||n.selected>=this.range.to)&&(this.range=Ht(n.options.length,n.selected,this.view.state.facet(B).maxRenderedOptions),this.showOptions(n.options,e.id)),this.updateSelectedOption(n.selected)){this.destroyInfo();let{completion:o}=n.options[n.selected],{info:r}=o;if(!r)return;let i=typeof r=="string"?document.createTextNode(r):r(o);if(!i)return;"then"in i?i.then(s=>{s&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(s,o)}).catch(s=>ft(this.view.state,s,"completion info")):this.addInfoPane(i,o)}}addInfoPane(e,n){this.destroyInfo();let o=this.info=document.createElement("div");if(o.className="cm-tooltip cm-completionInfo",e.nodeType!=null)o.appendChild(e),this.infoDestroy=null;else{let{dom:r,destroy:i}=e;o.appendChild(r),this.infoDestroy=i||null}this.dom.appendChild(o),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let n=null;for(let o=this.list.firstChild,r=this.range.from;o;o=o.nextSibling,r++)o.nodeName!="LI"||!o.id?r--:r==e?o.hasAttribute("aria-selected")||(o.setAttribute("aria-selected","true"),n=o):o.hasAttribute("aria-selected")&&o.removeAttribute("aria-selected");return n&&Ca(this.list,n),n}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let n=this.dom.getBoundingClientRect(),o=this.info.getBoundingClientRect(),r=e.getBoundingClientRect(),i=this.space;if(!i){let s=this.dom.ownerDocument.defaultView||window;i={left:0,top:0,right:s.innerWidth,bottom:s.innerHeight}}return r.top>Math.min(i.bottom,n.bottom)-10||r.bottom<Math.max(i.top,n.top)+10?null:this.view.state.facet(B).positionInfo(this.view,n,r,o,i,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,n,o){const r=document.createElement("ul");r.id=n,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions"));let i=null;for(let s=o.from;s<o.to;s++){let{completion:l,match:a}=e[s],{section:c}=l;if(c){let h=typeof c=="string"?c:c.name;if(h!=i&&(s>o.from||o.from==0))if(i=h,typeof c!="string"&&c.header)r.appendChild(c.header(c));else{let d=r.appendChild(document.createElement("completion-section"));d.textContent=h}}const f=r.appendChild(document.createElement("li"));f.id=n+"-"+s,f.setAttribute("role","option");let u=this.optionClass(l);u&&(f.className=u);for(let h of this.optionContent){let d=h(l,this.view.state,this.view,a);d&&f.appendChild(d)}}return o.from&&r.classList.add("cm-completionListIncompleteTop"),o.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function ka(t,e){return n=>new xa(n,t,e)}function Ca(t,e){let n=t.getBoundingClientRect(),o=e.getBoundingClientRect(),r=n.height/t.offsetHeight;o.top<n.top?t.scrollTop-=(n.top-o.top)/r:o.bottom>n.bottom&&(t.scrollTop+=(o.bottom-n.bottom)/r)}function vo(t){return(t.boost||0)*100+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}function Sa(t,e){let n=[],o=null,r=c=>{n.push(c);let{section:f}=c.completion;if(f){o||(o=[]);let u=typeof f=="string"?f:f.name;o.some(h=>h.name==u)||o.push(typeof f=="string"?{name:u}:f)}},i=e.facet(B);for(let c of t)if(c.hasResult()){let f=c.result.getMatch;if(c.result.filter===!1)for(let u of c.result.options)r(new _o(u,c.source,f?f(u):[],1e9-n.length));else{let u=e.sliceDoc(c.from,c.to),h,d=i.filterStrict?new ya(u):new _a(u);for(let m of c.result.options)if(h=d.match(m.label)){let v=m.displayLabel?f?f(m,h.matched):[]:h.matched;r(new _o(m,c.source,v,h.score+(m.boost||0)))}}}if(o){let c=Object.create(null),f=0,u=(h,d)=>{var m,v;return((m=h.rank)!==null&&m!==void 0?m:1e9)-((v=d.rank)!==null&&v!==void 0?v:1e9)||(h.name<d.name?-1:1)};for(let h of o.sort(u))f-=1e5,c[h.name]=f;for(let h of n){let{section:d}=h.completion;d&&(h.score+=c[typeof d=="string"?d:d.name])}}let s=[],l=null,a=i.compareCompletions;for(let c of n.sort((f,u)=>u.score-f.score||a(f.completion,u.completion))){let f=c.completion;!l||l.label!=f.label||l.detail!=f.detail||l.type!=null&&f.type!=null&&l.type!=f.type||l.apply!=f.apply||l.boost!=f.boost?s.push(c):vo(c.completion)>vo(l)&&(s[s.length-1]=c),l=c.completion}return s}class Ce{constructor(e,n,o,r,i,s){this.options=e,this.attrs=n,this.tooltip=o,this.timestamp=r,this.selected=i,this.disabled=s}setSelected(e,n){return e==this.selected||e>=this.options.length?this:new Ce(this.options,xo(n,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,n,o,r,i){let s=Sa(e,n);if(!s.length)return r&&e.some(a=>a.state==1)?new Ce(r.options,r.attrs,r.tooltip,r.timestamp,r.selected,!0):null;let l=n.facet(B).selectOnOpen?0:-1;if(r&&r.selected!=l&&r.selected!=-1){let a=r.options[r.selected].completion;for(let c=0;c<s.length;c++)if(s[c].completion==a){l=c;break}}return new Ce(s,xo(o,l),{pos:e.reduce((a,c)=>c.hasResult()?Math.min(a,c.from):a,1e8),create:Ea,above:i.aboveCursor},r?r.timestamp:Date.now(),l,!1)}map(e){return new Ce(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class kt{constructor(e,n,o){this.active=e,this.id=n,this.open=o}static start(){return new kt(La,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:n}=e,o=n.facet(B),i=(o.override||n.languageDataAt("autocomplete",ue(n)).map(ga)).map(l=>(this.active.find(c=>c.source==l)||new H(l,this.active.some(c=>c.state!=0)?1:0)).update(e,o));i.length==this.active.length&&i.every((l,a)=>l==this.active[a])&&(i=this.active);let s=this.open;s&&e.docChanged&&(s=s.map(e.changes)),e.selection||i.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!Aa(i,this.active)?s=Ce.build(i,n,this.id,s,o):s&&s.disabled&&!i.some(l=>l.state==1)&&(s=null),!s&&i.every(l=>l.state!=1)&&i.some(l=>l.hasResult())&&(i=i.map(l=>l.hasResult()?new H(l.source,0):l));for(let l of e.effects)l.is(yi)&&(s=s&&s.setSelected(l.value,this.id));return i==this.active&&s==this.open?this:new kt(i,this.id,s)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?wa:Ma}}function Aa(t,e){if(t==e)return!0;for(let n=0,o=0;;){for(;n<t.length&&!t[n].hasResult;)n++;for(;o<e.length&&!e[o].hasResult;)o++;let r=n==t.length,i=o==e.length;if(r||i)return r==i;if(t[n++].result!=e[o++].result)return!1}}const wa={"aria-autocomplete":"list"},Ma={};function xo(t,e){let n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(n["aria-activedescendant"]=t+"-"+e),n}const La=[];function gi(t,e){if(t.isUserEvent("input.complete")){let o=t.annotation(mi);if(o&&e.activateOnCompletion(o))return 12}let n=t.isUserEvent("input.type");return n&&e.activateOnTyping?5:n?1:t.isUserEvent("delete.backward")?2:t.selection?8:t.docChanged?16:0}class H{constructor(e,n,o=-1){this.source=e,this.state=n,this.explicitPos=o}hasResult(){return!1}update(e,n){let o=gi(e,n),r=this;(o&8||o&16&&this.touches(e))&&(r=new H(r.source,0)),o&4&&r.state==0&&(r=new H(this.source,1)),r=r.updateFor(e,o);for(let i of e.effects)if(i.is(xt))r=new H(r.source,1,i.value?ue(e.state):-1);else if(i.is(ze))r=new H(r.source,0);else if(i.is(_i))for(let s of i.value)s.source==r.source&&(r=s);return r}updateFor(e,n){return this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new H(this.source,this.state,e.mapPos(this.explicitPos))}touches(e){return e.changes.touchesRange(ue(e.state))}}class Ae extends H{constructor(e,n,o,r,i){super(e,2,n),this.result=o,this.from=r,this.to=i}hasResult(){return!0}updateFor(e,n){var o;if(!(n&3))return this.map(e.changes);let r=this.result;r.map&&!e.changes.empty&&(r=r.map(r,e.changes));let i=e.changes.mapPos(this.from),s=e.changes.mapPos(this.to,1),l=ue(e.state);if((this.explicitPos<0?l<=i:l<this.from)||l>s||!r||n&2&&ue(e.startState)==this.from)return new H(this.source,n&4?1:0);let a=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos);return Da(r.validFor,e.state,i,s)?new Ae(this.source,a,r,i,s):r.update&&(r=r.update(r,i,s,new di(e.state,l,a>=0)))?new Ae(this.source,a,r,r.from,(o=r.to)!==null&&o!==void 0?o:ue(e.state)):new H(this.source,1,a)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new Ae(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new H(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function Da(t,e,n,o){if(!t)return!1;let r=e.sliceDoc(n,o);return typeof t=="function"?t(r,n,o,e):pi(t,!0).test(r)}const _i=O.define({map(t,e){return t.map(n=>n.map(e))}}),yi=O.define(),N=Ee.define({create(){return kt.start()},update(t,e){return t.update(e)},provide:t=>[Ri.from(t,e=>e.tooltip),k.contentAttributes.from(t,e=>e.attrs)]});function In(t,e){const n=e.completion.apply||e.completion.label;let o=t.state.field(N).active.find(r=>r.source==e.source);return o instanceof Ae?(typeof n=="string"?t.dispatch(Object.assign(Object.assign({},ma(t.state,n,o.from,o.to)),{annotations:mi.of(e.completion)})):n(t,e.completion,o.from,o.to),!0):!1}const Ea=ka(N,In);function st(t,e="option"){return n=>{let o=n.state.field(N,!1);if(!o||!o.open||o.open.disabled||Date.now()-o.open.timestamp<n.state.facet(B).interactionDelay)return!1;let r=1,i;e=="page"&&(i=Wo(n,o.open.tooltip))&&(r=Math.max(2,Math.floor(i.dom.offsetHeight/i.dom.querySelector("li").offsetHeight)-1));let{length:s}=o.open.options,l=o.open.selected>-1?o.open.selected+r*(t?1:-1):t?0:s-1;return l<0?l=e=="page"?0:s-1:l>=s&&(l=e=="page"?s-1:0),n.dispatch({effects:yi.of(l)}),!0}}const Ta=t=>{let e=t.state.field(N,!1);return t.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<t.state.facet(B).interactionDelay?!1:In(t,e.open.options[e.open.selected])},Ba=t=>t.state.field(N,!1)?(t.dispatch({effects:xt.of(!0)}),!0):!1,Oa=t=>{let e=t.state.field(N,!1);return!e||!e.active.some(n=>n.state!=0)?!1:(t.dispatch({effects:ze.of(null)}),!0)};class Ra{constructor(e,n){this.active=e,this.context=n,this.time=Date.now(),this.updates=[],this.done=void 0}}const Ia=50,Pa=1e3,$a=St.fromClass(class{constructor(t){this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of t.state.field(N).active)e.state==1&&this.startQuery(e)}update(t){let e=t.state.field(N),n=t.state.facet(B);if(!t.selectionSet&&!t.docChanged&&t.startState.field(N)==e)return;let o=t.transactions.some(i=>{let s=gi(i,n);return s&8||(i.selection||i.docChanged)&&!(s&3)});for(let i=0;i<this.running.length;i++){let s=this.running[i];if(o||s.context.abortOnDocChange&&t.docChanged||s.updates.length+t.transactions.length>Ia&&Date.now()-s.time>Pa){for(let l of s.context.abortListeners)try{l()}catch(a){ft(this.view.state,a)}s.context.abortListeners=null,this.running.splice(i--,1)}else s.updates.push(...t.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),t.transactions.some(i=>i.effects.some(s=>s.is(xt)))&&(this.pendingStart=!0);let r=this.pendingStart?50:n.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(i=>i.state==1&&!this.running.some(s=>s.active.source==i.source))?setTimeout(()=>this.startUpdate(),r):-1,this.composing!=0)for(let i of t.transactions)i.isUserEvent("input.type")?this.composing=2:this.composing==2&&i.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:t}=this.view,e=t.field(N);for(let n of e.active)n.state==1&&!this.running.some(o=>o.active.source==n.source)&&this.startQuery(n)}startQuery(t){let{state:e}=this.view,n=ue(e),o=new di(e,n,t.explicitPos==n,this.view),r=new Ra(t,o);this.running.push(r),Promise.resolve(t.source(o)).then(i=>{r.context.aborted||(r.done=i||null,this.scheduleAccept())},i=>{this.view.dispatch({effects:ze.of(null)}),ft(this.view.state,i)})}scheduleAccept(){this.running.every(t=>t.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(B).updateSyncTime))}accept(){var t;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],n=this.view.state.facet(B);for(let o=0;o<this.running.length;o++){let r=this.running[o];if(r.done===void 0)continue;if(this.running.splice(o--,1),r.done){let s=new Ae(r.active.source,r.active.explicitPos,r.done,r.done.from,(t=r.done.to)!==null&&t!==void 0?t:ue(r.updates.length?r.updates[0].startState:this.view.state));for(let l of r.updates)s=s.update(l,n);if(s.hasResult()){e.push(s);continue}}let i=this.view.state.field(N).active.find(s=>s.source==r.active.source);if(i&&i.state==1)if(r.done==null){let s=new H(r.active.source,0);for(let l of r.updates)s=s.update(l,n);s.state!=1&&e.push(s)}else this.startQuery(i)}e.length&&this.view.dispatch({effects:_i.of(e)})}},{eventHandlers:{blur(t){let e=this.view.state.field(N,!1);if(e&&e.tooltip&&this.view.state.facet(B).closeOnBlur){let n=e.open&&Wo(this.view,e.open.tooltip);(!n||!n.dom.contains(t.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:ze.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:xt.of(!1)}),20),this.composing=0}}}),Na=typeof navigator=="object"&&/Win/.test(navigator.platform),Wa=cn.highest(k.domEventHandlers({keydown(t,e){let n=e.state.field(N,!1);if(!n||!n.open||n.open.disabled||n.open.selected<0||t.key.length>1||t.ctrlKey&&!(Na&&t.altKey)||t.metaKey)return!1;let o=n.open.options[n.open.selected],r=n.active.find(s=>s.source==o.source),i=o.completion.commitCharacters||r.result.commitCharacters;return i&&i.indexOf(t.key)>-1&&In(e,o),!1}})),Fa=k.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),qe={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},me=O.define({map(t,e){let n=e.mapPos(t,-1,Pi.TrackAfter);return n??void 0}}),Pn=new class extends $i{};Pn.startSide=1;Pn.endSide=-1;const bi=Ee.define({create(){return Ii.empty},update(t,e){if(t=t.map(e.changes),e.selection){let n=e.state.doc.lineAt(e.selection.main.head);t=t.update({filter:o=>o>=n.from&&o<=n.to})}for(let n of e.effects)n.is(me)&&(t=t.update({add:[Pn.range(n.value,n.value+1)]}));return t}});function Ua(){return[Va,bi]}const Vt="()[]{}<>";function vi(t){for(let e=0;e<Vt.length;e+=2)if(Vt.charCodeAt(e)==t)return Vt.charAt(e+1);return fn(t<128?t:t+1)}function xi(t,e){return t.languageDataAt("closeBrackets",e)[0]||qe}const Ha=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),Va=k.inputHandler.of((t,e,n,o)=>{if((Ha?t.composing:t.compositionStarted)||t.state.readOnly)return!1;let r=t.state.selection.main;if(o.length>2||o.length==2&&re(j(o,0))==1||e!=r.from||n!=r.to)return!1;let i=ja(t.state,o);return i?(t.dispatch(i),!0):!1}),za=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let o=xi(t,t.selection.main.head).brackets||qe.brackets,r=null,i=t.changeByRange(s=>{if(s.empty){let l=Ka(t.doc,s.head);for(let a of o)if(a==l&&Ot(t.doc,s.head)==vi(j(a,0)))return{changes:{from:s.head-a.length,to:s.head+a.length},range:_.cursor(s.head-a.length)}}return{range:r=s}});return r||e(t.update(i,{scrollIntoView:!0,userEvent:"delete.backward"})),!r},qa=[{key:"Backspace",run:za}];function ja(t,e){let n=xi(t,t.selection.main.head),o=n.brackets||qe.brackets;for(let r of o){let i=vi(j(r,0));if(e==r)return i==r?Qa(t,r,o.indexOf(r+r+r)>-1,n):Ga(t,r,i,n.before||qe.before);if(e==i&&ki(t,t.selection.main.from))return Ja(t,r,i)}return null}function ki(t,e){let n=!1;return t.field(bi).between(0,t.doc.length,o=>{o==e&&(n=!0)}),n}function Ot(t,e){let n=t.sliceString(e,e+2);return n.slice(0,re(j(n,0)))}function Ka(t,e){let n=t.sliceString(e-2,e);return re(j(n,0))==n.length?n:n.slice(1)}function Ga(t,e,n,o){let r=null,i=t.changeByRange(s=>{if(!s.empty)return{changes:[{insert:e,from:s.from},{insert:n,from:s.to}],effects:me.of(s.to+e.length),range:_.range(s.anchor+e.length,s.head+e.length)};let l=Ot(t.doc,s.head);return!l||/\s/.test(l)||o.indexOf(l)>-1?{changes:{insert:e+n,from:s.head},effects:me.of(s.head+e.length),range:_.cursor(s.head+e.length)}:{range:r=s}});return r?null:t.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function Ja(t,e,n){let o=null,r=t.changeByRange(i=>i.empty&&Ot(t.doc,i.head)==n?{changes:{from:i.head,to:i.head+n.length,insert:n},range:_.cursor(i.head+n.length)}:o={range:i});return o?null:t.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function Qa(t,e,n,o){let r=o.stringPrefixes||qe.stringPrefixes,i=null,s=t.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:e,from:l.to}],effects:me.of(l.to+e.length),range:_.range(l.anchor+e.length,l.head+e.length)};let a=l.head,c=Ot(t.doc,a),f;if(c==e){if(ko(t,a))return{changes:{insert:e+e,from:a},effects:me.of(a+e.length),range:_.cursor(a+e.length)};if(ki(t,a)){let h=n&&t.sliceDoc(a,a+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:a,to:a+h.length,insert:h},range:_.cursor(a+h.length)}}}else{if(n&&t.sliceDoc(a-2*e.length,a)==e+e&&(f=Co(t,a-2*e.length,r))>-1&&ko(t,f))return{changes:{insert:e+e+e+e,from:a},effects:me.of(a+e.length),range:_.cursor(a+e.length)};if(t.charCategorizer(a)(c)!=P.Word&&Co(t,a,r)>-1&&!Ya(t,a,e,r))return{changes:{insert:e+e,from:a},effects:me.of(a+e.length),range:_.cursor(a+e.length)}}return{range:i=l}});return i?null:t.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function ko(t,e){let n=Be(t).resolveInner(e+1);return n.parent&&n.from==e}function Ya(t,e,n,o){let r=Be(t).resolveInner(e,-1),i=o.reduce((s,l)=>Math.max(s,l.length),0);for(let s=0;s<5;s++){let l=t.sliceDoc(r.from,Math.min(r.to,r.from+n.length+i)),a=l.indexOf(n);if(!a||a>-1&&o.indexOf(l.slice(0,a))>-1){let f=r.firstChild;for(;f&&f.from==r.from&&f.to-f.from>n.length+a;){if(t.sliceDoc(f.to-n.length,f.to)==n)return!1;f=f.firstChild}return!0}let c=r.to==e&&r.parent;if(!c)break;r=c}return!1}function Co(t,e,n){let o=t.charCategorizer(e);if(o(t.sliceDoc(e-1,e))!=P.Word)return e;for(let r of n){let i=e-r.length;if(t.sliceDoc(i,e)==r&&o(t.sliceDoc(i-1,i))!=P.Word)return i}return-1}function Za(t={}){return[Wa,N,B.of(t),$a,Xa,Fa]}const Ci=[{key:"Ctrl-Space",run:Ba},{key:"Escape",run:Oa},{key:"ArrowDown",run:st(!0)},{key:"ArrowUp",run:st(!1)},{key:"PageDown",run:st(!0,"page")},{key:"PageUp",run:st(!1,"page")},{key:"Enter",run:Ta}],Xa=cn.highest(hn.computeN([B],t=>t.facet(B).defaultKeymap?[Ci]:[]));class ec{constructor(e,n,o){this.from=e,this.to=n,this.diagnostic=o}}class pe{constructor(e,n,o){this.diagnostics=e,this.panel=n,this.selected=o}static init(e,n,o){let r=e,i=o.facet(X).markerFilter;i&&(r=i(r,o));let s=D.set(r.map(l=>l.from==l.to||l.from==l.to-1&&o.doc.lineAt(l.from).to==l.from?D.widget({widget:new uc(l),diagnostic:l}).range(l.from):D.mark({attributes:{class:"cm-lintRange cm-lintRange-"+l.severity+(l.markClass?" "+l.markClass:"")},diagnostic:l}).range(l.from,l.to)),!0);return new pe(s,n,De(s))}}function De(t,e=null,n=0){let o=null;return t.between(n,1e9,(r,i,{spec:s})=>{if(!(e&&s.diagnostic!=e))return o=new ec(r,i,s.diagnostic),!1}),o}function tc(t,e){let n=e.pos,o=e.end||n,r=t.state.facet(X).hideOn(t,n,o);if(r!=null)return r;let i=t.startState.doc.lineAt(e.pos);return!!(t.effects.some(s=>s.is($n))||t.changes.touchesRange(i.from,Math.max(i.to,o)))}function Si(t,e){return t.field(V,!1)?e:e.concat(O.appendConfig.of(Li))}function nc(t,e){return{effects:Si(t,[$n.of(e)])}}const $n=O.define(),Nn=O.define(),Ai=O.define(),V=Ee.define({create(){return new pe(D.none,null,null)},update(t,e){if(e.docChanged&&t.diagnostics.size){let n=t.diagnostics.map(e.changes),o=null,r=t.panel;if(t.selected){let i=e.changes.mapPos(t.selected.from,1);o=De(n,t.selected.diagnostic,i)||De(n,null,i)}!n.size&&r&&e.state.facet(X).autoPanel&&(r=null),t=new pe(n,r,o)}for(let n of e.effects)if(n.is($n)){let o=e.state.facet(X).autoPanel?n.value.length?je.open:null:t.panel;t=pe.init(n.value,o,e.state)}else n.is(Nn)?t=new pe(t.diagnostics,n.value?je.open:null,t.selected):n.is(Ai)&&(t=new pe(t.diagnostics,t.panel,n.value));return t},provide:t=>[un.from(t,e=>e.panel),k.decorations.from(t,e=>e.diagnostics)]}),oc=D.mark({class:"cm-lintRange cm-lintRange-active"});function rc(t,e,n){let{diagnostics:o}=t.state.field(V),r=[],i=2e8,s=0;o.between(e-(n<0?1:0),e+(n>0?1:0),(a,c,{spec:f})=>{e>=a&&e<=c&&(a==c||(e>a||n>0)&&(e<c||n<0))&&(r.push(f.diagnostic),i=Math.min(a,i),s=Math.max(c,s))});let l=t.state.facet(X).tooltipFilter;return l&&(r=l(r,t.state)),r.length?{pos:i,end:s,above:t.state.doc.lineAt(i).to<s,create(){return{dom:ic(t,r)}}}:null}function ic(t,e){return S("ul",{class:"cm-tooltip-lint"},e.map(n=>Mi(t,n,!1)))}const sc=t=>{let e=t.state.field(V,!1);(!e||!e.panel)&&t.dispatch({effects:Si(t.state,[Nn.of(!0)])});let n=We(t,je.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0},So=t=>{let e=t.state.field(V,!1);return!e||!e.panel?!1:(t.dispatch({effects:Nn.of(!1)}),!0)},lc=t=>{let e=t.state.field(V,!1);if(!e)return!1;let n=t.state.selection.main,o=e.diagnostics.iter(n.to+1);return!o.value&&(o=e.diagnostics.iter(0),!o.value||o.from==n.from&&o.to==n.to)?!1:(t.dispatch({selection:{anchor:o.from,head:o.to},scrollIntoView:!0}),!0)},ac=[{key:"Mod-Shift-m",run:sc,preventDefault:!0},{key:"F8",run:lc}],cc=St.fromClass(class{constructor(t){this.view=t,this.timeout=-1,this.set=!0;let{delay:e}=t.state.facet(X);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){clearTimeout(this.timeout);let t=Date.now();if(t<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-t);else{this.set=!1;let{state:e}=this.view,{sources:n}=e.facet(X);n.length&&Promise.all(n.map(o=>Promise.resolve(o(this.view)))).then(o=>{let r=o.reduce((i,s)=>i.concat(s));this.view.state.doc==e.doc&&this.view.dispatch(nc(this.view.state,r))},o=>{ft(this.view.state,o)})}}update(t){let e=t.state.facet(X);(t.docChanged||e!=t.startState.facet(X)||e.needsRefresh&&e.needsRefresh(t))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),X=Te.define({combine(t){return Object.assign({sources:t.map(e=>e.source).filter(e=>e!=null)},Ke(t.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,n)=>e?n?o=>e(o)||n(o):e:n}))}});function Rc(t,e={}){return[X.of({source:t,config:e}),cc,Li]}function wi(t){let e=[];if(t)e:for(let{name:n}of t){for(let o=0;o<n.length;o++){let r=n[o];if(/[a-zA-Z]/.test(r)&&!e.some(i=>i.toLowerCase()==r.toLowerCase())){e.push(r);continue e}}e.push("")}return e}function Mi(t,e,n){var o;let r=n?wi(e.actions):[];return S("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},S("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(t):e.message),(o=e.actions)===null||o===void 0?void 0:o.map((i,s)=>{let l=!1,a=h=>{if(h.preventDefault(),l)return;l=!0;let d=De(t.state.field(V).diagnostics,e);d&&i.apply(t,d.from,d.to)},{name:c}=i,f=r[s]?c.indexOf(r[s]):-1,u=f<0?c:[c.slice(0,f),S("u",c.slice(f,f+1)),c.slice(f+1)];return S("button",{type:"button",class:"cm-diagnosticAction",onclick:a,onmousedown:a,"aria-label":` Action: ${c}${f<0?"":` (access key "${r[s]})"`}.`},u)}),e.source&&S("div",{class:"cm-diagnosticSource"},e.source))}class uc extends Wi{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return S("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Ao{constructor(e,n){this.diagnostic=n,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Mi(e,n,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class je{constructor(e){this.view=e,this.items=[];let n=r=>{if(r.keyCode==27)So(this.view),this.view.focus();else if(r.keyCode==38||r.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(r.keyCode==40||r.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(r.keyCode==36)this.moveSelection(0);else if(r.keyCode==35)this.moveSelection(this.items.length-1);else if(r.keyCode==13)this.view.focus();else if(r.keyCode>=65&&r.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:i}=this.items[this.selectedIndex],s=wi(i.actions);for(let l=0;l<s.length;l++)if(s[l].toUpperCase().charCodeAt(0)==r.keyCode){let a=De(this.view.state.field(V).diagnostics,i);a&&i.actions[l].apply(e,a.from,a.to)}}else return;r.preventDefault()},o=r=>{for(let i=0;i<this.items.length;i++)this.items[i].dom.contains(r.target)&&this.moveSelection(i)};this.list=S("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:n,onclick:o}),this.dom=S("div",{class:"cm-panel-lint"},this.list,S("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>So(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(V).selected;if(!e)return-1;for(let n=0;n<this.items.length;n++)if(this.items[n].diagnostic==e.diagnostic)return n;return-1}update(){let{diagnostics:e,selected:n}=this.view.state.field(V),o=0,r=!1,i=null;for(e.between(0,this.view.state.doc.length,(s,l,{spec:a})=>{let c=-1,f;for(let u=o;u<this.items.length;u++)if(this.items[u].diagnostic==a.diagnostic){c=u;break}c<0?(f=new Ao(this.view,a.diagnostic),this.items.splice(o,0,f),r=!0):(f=this.items[c],c>o&&(this.items.splice(o,c-o),r=!0)),n&&f.diagnostic==n.diagnostic?f.dom.hasAttribute("aria-selected")||(f.dom.setAttribute("aria-selected","true"),i=f):f.dom.hasAttribute("aria-selected")&&f.dom.removeAttribute("aria-selected"),o++});o<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();this.items.length==0&&(this.items.push(new Ao(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),i?(this.list.setAttribute("aria-activedescendant",i.id),this.view.requestMeasure({key:this,read:()=>({sel:i.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:s,panel:l})=>{let a=l.height/this.list.offsetHeight;s.top<l.top?this.list.scrollTop-=(l.top-s.top)/a:s.bottom>l.bottom&&(this.list.scrollTop+=(s.bottom-l.bottom)/a)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function n(){let o=e;e=o.nextSibling,o.remove()}for(let o of this.items)if(o.dom.parentNode==this.list){for(;e!=o.dom;)n();e=o.dom.nextSibling}else this.list.insertBefore(o.dom,e);for(;e;)n()}moveSelection(e){if(this.selectedIndex<0)return;let n=this.view.state.field(V),o=De(n.diagnostics,this.items[e].diagnostic);o&&this.view.dispatch({selection:{anchor:o.from,head:o.to},scrollIntoView:!0,effects:Ai.of(o)})}static open(e){return new je(e)}}function fc(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}function lt(t){return fc(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const hc=k.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:lt("#d11")},".cm-lintRange-warning":{backgroundImage:lt("orange")},".cm-lintRange-info":{backgroundImage:lt("#999")},".cm-lintRange-hint":{backgroundImage:lt("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),Li=[V,k.decorations.compute([V],t=>{let{selected:e,panel:n}=t.field(V);return!e||!n||e.from==e.to?D.none:D.set([oc.range(e.from,e.to)])}),Ni(rc,{hideOn:tc}),hc];var wo=function(e){e===void 0&&(e={});var{crosshairCursor:n=!1}=e,o=[];e.closeBracketsKeymap!==!1&&(o=o.concat(qa)),e.defaultKeymap!==!1&&(o=o.concat($l)),e.searchKeymap!==!1&&(o=o.concat(ca)),e.historyKeymap!==!1&&(o=o.concat(qs)),e.foldKeymap!==!1&&(o=o.concat(Fi)),e.completionKeymap!==!1&&(o=o.concat(Ci)),e.lintKeymap!==!1&&(o=o.concat(ac));var r=[];return e.lineNumbers!==!1&&r.push(Ui()),e.highlightActiveLineGutter!==!1&&r.push(Hi()),e.highlightSpecialChars!==!1&&r.push(Vi()),e.history!==!1&&r.push(Ps()),e.foldGutter!==!1&&r.push(zi()),e.drawSelection!==!1&&r.push(qi()),e.dropCursor!==!1&&r.push(ji()),e.allowMultipleSelections!==!1&&r.push(Fe.allowMultipleSelections.of(!0)),e.indentOnInput!==!1&&r.push(Ki()),e.syntaxHighlighting!==!1&&r.push(ln(Zi,{fallback:!0})),e.bracketMatching!==!1&&r.push(Gi()),e.closeBrackets!==!1&&r.push(Ua()),e.autocompletion!==!1&&r.push(Za()),e.rectangularSelection!==!1&&r.push(Ji()),n!==!1&&r.push(Qi()),e.highlightActiveLine!==!1&&r.push(Yi()),e.highlightSelectionMatches!==!1&&r.push(zl()),e.tabSize&&typeof e.tabSize=="number"&&r.push(No.of(" ".repeat(e.tabSize))),r.concat([hn.of(o.flat())]).filter(Boolean)};const dc="#e5c07b",Mo="#e06c75",pc="#56b6c2",mc="#ffffff",ct="#abb2bf",sn="#7d8799",gc="#61afef",_c="#98c379",Lo="#d19a66",yc="#c678dd",bc="#21252b",Do="#2c313a",Eo="#282c34",zt="#353a42",vc="#3E4451",To="#528bff",xc=k.theme({"&":{color:ct,backgroundColor:Eo},".cm-content":{caretColor:To},".cm-cursor, .cm-dropCursor":{borderLeftColor:To},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:vc},".cm-panels":{backgroundColor:bc,color:ct},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:Eo,color:sn,border:"none"},".cm-activeLineGutter":{backgroundColor:Do},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:zt},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:zt,borderBottomColor:zt},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:Do,color:ct}}},{dark:!0}),kc=Oo.define([{tag:g.keyword,color:yc},{tag:[g.name,g.deleted,g.character,g.propertyName,g.macroName],color:Mo},{tag:[g.function(g.variableName),g.labelName],color:gc},{tag:[g.color,g.constant(g.name),g.standard(g.name)],color:Lo},{tag:[g.definition(g.name),g.separator],color:ct},{tag:[g.typeName,g.className,g.number,g.changed,g.annotation,g.modifier,g.self,g.namespace],color:dc},{tag:[g.operator,g.operatorKeyword,g.url,g.escape,g.regexp,g.link,g.special(g.string)],color:pc},{tag:[g.meta,g.comment],color:sn},{tag:g.strong,fontWeight:"bold"},{tag:g.emphasis,fontStyle:"italic"},{tag:g.strikethrough,textDecoration:"line-through"},{tag:g.link,color:sn,textDecoration:"underline"},{tag:g.heading,fontWeight:"bold",color:Mo},{tag:[g.atom,g.bool,g.special(g.variableName)],color:Lo},{tag:[g.processingInstruction,g.string,g.inserted],color:_c},{tag:g.invalid,color:mc}]),Cc=[xc,ln(kc)];var Sc=k.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),Ac=function(e){e===void 0&&(e={});var{indentWithTab:n=!0,editable:o=!0,readOnly:r=!1,theme:i="light",placeholder:s="",basicSetup:l=!0}=e,a=[];switch(n&&a.unshift(hn.of([Nl])),l&&(typeof l=="boolean"?a.unshift(wo()):a.unshift(wo(l))),s&&a.unshift(Xi(s)),i){case"light":a.push(Sc);break;case"dark":a.push(Cc);break;case"none":break;default:a.push(i);break}return o===!1&&a.push(k.editable.of(!1)),r&&a.push(Fe.readOnly.of(!0)),[...a]},wc=t=>({line:t.state.doc.lineAt(t.state.selection.main.from),lineCount:t.state.doc.lines,lineBreak:t.state.lineBreak,length:t.state.doc.length,readOnly:t.state.readOnly,tabSize:t.state.tabSize,selection:t.state.selection,selectionAsSingle:t.state.selection.asSingle().main,ranges:t.state.selection.ranges,selectionCode:t.state.sliceDoc(t.state.selection.main.from,t.state.selection.main.to),selections:t.state.selection.ranges.map(e=>t.state.sliceDoc(e.from,e.to)),selectedText:t.state.selection.ranges.some(e=>!e.empty)}),Bo=Ct.define(),Mc=[];function Lc(t){var{value:e,selection:n,onChange:o,onStatistics:r,onCreateEditor:i,onUpdate:s,extensions:l=Mc,autoFocus:a,theme:c="light",height:f=null,minHeight:u=null,maxHeight:h=null,width:d=null,minWidth:m=null,maxWidth:v=null,placeholder:x="",editable:b=!0,readOnly:p=!1,indentWithTab:E=!0,basicSetup:w=!0,root:M,initialState:R}=t,[F,oe]=ae(),[A,z]=ae(),[T,q]=ae(),Rt=k.theme({"&":{height:f,minHeight:u,maxHeight:h,width:d,minWidth:m,maxWidth:v},"& .cm-scroller":{height:"100% !important"}}),et=k.updateListener.of($=>{if($.docChanged&&typeof o=="function"&&!$.transactions.some(Di=>Di.annotation(Bo))){var Ie=$.state.doc,tt=Ie.toString();o(tt,$)}r&&r(wc($))}),It=Ac({theme:c,editable:b,readOnly:p,placeholder:x,indentWithTab:E,basicSetup:w}),he=[et,Rt,...It];return s&&typeof s=="function"&&he.push(k.updateListener.of(s)),he=he.concat(l),ye(()=>{if(F&&!T){var $={doc:e,selection:n,extensions:he},Ie=R?Fe.fromJSON(R.json,$,R.fields):Fe.create($);if(q(Ie),!A){var tt=new k({state:Ie,parent:F,root:M});z(tt),i&&i(tt,Ie)}}return()=>{A&&(q(void 0),z(void 0))}},[F,T]),ie(()=>{t.container&&oe(t.container)},[t.container]),ie(()=>()=>{A&&(A.destroy(),z(void 0))},[A]),ie(()=>{a&&A&&A.focus()},[a,A]),ie(()=>{A&&A.dispatch({effects:O.reconfigure.of(he)})},[c,l,f,u,h,d,m,v,x,b,p,E,w,o,s]),ie(()=>{if(e!==void 0){var $=A?A.state.doc.toString():"";A&&e!==$&&A.dispatch({changes:{from:0,to:$.length,insert:e||""},annotations:[Bo.of(!0)]})}},[e,A]),{state:T,setState:q,view:A,setView:z,container:F,setContainer:oe}}var Dc=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],Ec=wn((t,e)=>{var{className:n,value:o="",selection:r,extensions:i=[],onChange:s,onStatistics:l,onCreateEditor:a,onUpdate:c,autoFocus:f,theme:u="light",height:h,minHeight:d,maxHeight:m,width:v,minWidth:x,maxWidth:b,basicSetup:p,placeholder:E,indentWithTab:w,editable:M,readOnly:R,root:F,initialState:oe}=t,A=ws(t,Dc),z=wt(null),{state:T,view:q,container:Rt,setContainer:et}=Lc({root:F,value:o,autoFocus:f,theme:u,height:h,minHeight:d,maxHeight:m,width:v,minWidth:x,maxWidth:b,basicSetup:p,placeholder:E,indentWithTab:w,editable:M,readOnly:R,selection:r,onChange:s,onStatistics:l,onCreateEditor:a,onUpdate:c,extensions:i,initialState:oe});Mt(e,()=>({editor:z.current,state:T,view:q}),[z,Rt,T,q]);var It=Lt($=>{z.current=$,et($)},[et]);if(typeof o!="string")throw new Error("value must be typeof string but got "+typeof o);var he=typeof u=="string"?"cm-theme-"+u:"cm-theme";return ls("div",Zt({ref:It,className:""+he+(n?" "+n:"")},A))});Ec.displayName="CodeMirror";export{wt as A,wn as D,He as E,Mt as F,se as H,Ec as R,Qe as T,ee as _,ye as a,Oc as b,Bc as c,ae as d,te as k,Rc as l,Lt as q,ls as u,ie as y};
